# Quality Control


**Loading packages**

```{r, echo=TRUE, results="hide", warning=FALSE, message=FALSE}
library(XMAS2)
library(dplyr)
library(tibble)
library(phyloseq)
```

The taxonomic levels of spike-in sample's bacteria is species. Firstly, using the `summarize_taxa` to get the genus level phyloseq object and then do `run_RefCheck` under the optimal parameters.

## spike-in sample (BRS)

* get the BRS_ID
```{r, warning=FALSE, message=FALSE}
metaphlan2_ps_Species_LOD@sam_data
```

* run `run_RefCheck`
```{r, warning=FALSE, message=FALSE, collapse=TRUE}
run_RefCheck(
    ps=metaphlan2_ps_Species_LOD,
    BRS_ID="refE",
    Reference=NULL,
    Ref_type="MGS",
    Save=NULL)
```

## Spike-in sample's (BRS) remove
```{r, warning=FALSE, message=FALSE}
metaphlan2_ps_Species_LOD_remove_BRS <- get_GroupPhyloseq(
                     ps = metaphlan2_ps_Species_LOD,
                     group = "Group",
                     group_names = "QC")
metaphlan2_ps_Species_LOD_remove_BRS
```


## Systematic Information
```{r}
sessionInfo()
```