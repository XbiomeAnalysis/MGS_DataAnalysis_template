[["index.html", "MGS microbiota data analysis based on XMAS package Chapter 1 Prerequisites 1.1 Preparing for the tutorial 1.2 Workflow description", " MGS microbiota data analysis based on XMAS package Hua Zou 2023-10-27 Chapter 1 Prerequisites Here, we give users one example to practice the MGS microbiota data analysis workflow by XMAS 2.0. By the way, we also recommend users handling your own microbiota data in a reasonable manner when you utilize this package or workflow. Pay attention to whether your data fit the methods this package provided. 1.1 Preparing for the tutorial This tutorial requires that the users should have basic knowledge on R language and statistics. If you are new to microbial research, we recommend the Statistical Analysis of Microbiome Data with R (Xia et al. 2018) as guide book. We suggest users using local laptop because our own server have not deployed XMAS 2.0 package yet. In addition, installing the following software before using XMAS 2.0. R 3.6.3 or later release Download link. Rstudio Desktop Download link. 1.2 Workflow description The standard data analysis of 16S and MGS data by XMAS 2.0. The upstream process is performed by in-house pipeline. and this example just shows how to perform downstream data analysis. In briefly, the example comprises the following steps: Converting inputs into phyloseq object; Quality Evaluation; Pre-Processing Data; Diversity analysis; Ordination analysis; Composition analysis; Differential analysis. Figure 1.1: Functions of XMAS 2.0 References "],["convert-inputdata-into-phyloseq-object.html", "Chapter 2 Convert inputdata into phyloseq object 2.1 Metaphlan2/3 2.2 Transform the abundance of taxa whose relative abundance under Limit Of Detection (LOD) into Zeros 2.3 Systematic Information", " Chapter 2 Convert inputdata into phyloseq object r Biocpkg(“phyloseq”) (McMurdie and Holmes 2013) is the most popular Biocondcutor package used by the microbiome research field, and phyloseq-class objects are a great data-standard for microbiota data in R. Therefore, the core functions in XMAS take phyloseq-class object as input. In the phyloseq object, information on OTU abundances, taxonomy of OTUs, the phylogenetic tree and metadata is stored. This tutorial will introduce you the basic steps to convert results from the in-house pipeline into phyloseq-class object. More importantly on how to look at your data and filter appropriately. We will use the inputs from /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/. Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) 2.1 Metaphlan2/3 The result of the in-house Metaphlan2/3 pipeline. 2.1.1 Merging output of metaphlan go to the directory of metaphlan created by in-house metaphlan pipeline cd /share/projects/Engineering/pipeline_output/PipelineJob_141157_20220823/ extract the absolute path of output ls /share/projects/Engineering/pipeline_output/PipelineJob_141157_20220823/*/humann2/*.tsv | grep -E &quot;metaphlan&quot; &gt; metaphlan_BJ_RoundG_filepath.tsv Saving the following python codes into merge_metaphlan.py import argparse as ap import os import re import pandas as pd import numpy as np parser = ap.ArgumentParser(description=&#39;combining results from metaphlan&#39;) parser.add_argument(&#39;-f&#39;, &#39;--file&#39;, type=str, help=&#39;file contains metaphlan results&#39;, required=True) parser.add_argument(&#39;-p&#39;, &#39;--prefix&#39;, type=str, help=&#39;prefix of output&#39;, required=True) parser.add_argument(&#39;-t&#39;, &#39;--taxa&#39;, type=str, default=&quot;species&quot;, help=&#39;specific taxa level&#39;, required=False) parser.add_argument(&#39;-k&#39;, &#39;--kind&#39;, type=str, default=&quot;metaphlan2&quot;, help=&#39;version of metaphlan&#39;, required=False) parser.add_argument(&#39;-o&#39;, &#39;--out&#39;, type=str, default=&quot;./&quot;, help=&#39;output path&#39;, required=False) args = parser.parse_args() def Filename_to_filepath(filelist): file2path = {} with open(filelist, &#39;r&#39;) as f: files = f.readlines() for File in files: File = File.strip() if os.path.exists(File): # seqid is either numeric(18933) or character (CJR0607) FileName = str(re.match(r&#39;\\S+[humann2|humann3]\\/&#39; r&#39;(\\d+|\\d+\\_\\d+|\\d+\\_\\d+\\_\\d+|\\w+\\d+)&#39; r&#39;\\_metaphlan_\\S+_list.tsv&#39;, File)[1]) file2path[FileName] = File return(file2path) def Read_File(filenames, samplenames, taxalevels, filetype): if filetype == &#39;metaphlan2&#39;: # skip row with &#39;#&#39; and the 1st row dat = pd.read_table(filenames, sep=&#39;\\t&#39;, skip_blank_lines=True, comment=&#39;#&#39;, skiprows=1, header=None) dat1 = dat.iloc[:, 0:2] else: # skip row with &#39;#&#39; dat = pd.read_table(filenames, sep=&#39;\\t&#39;, skip_blank_lines=True, comment=&#39;#&#39;, #skiprows=1, header=None) dat1 = dat.iloc[:, [0, 2]] if taxalevels[0] == taxalevels[1]: df_temp = dat1[dat1.iloc[:, 0].str.contains(taxalevels[0])] else: # filtering the rows where taxa doesn&#39;t contains the specific taxa level df = dat1[dat1.iloc[:, 0].str.contains(taxalevels[0])] df_temp = df[df.iloc[:, 0].str.contains(taxalevels[1]) == False] # adding column name to the respective columns df_temp.columns = [&#39;taxaid&#39;, samplenames] res = df_temp.copy() # sorting by taxaid res.sort_values(&#39;taxaid&#39;, inplace=True) # dropping ALL duplicate values res.drop_duplicates( subset=&#39;taxaid&#39;, keep=False, inplace=True) return(res) def Merge_Metaphlan(filedict, taxa, filetype): if taxa == &quot;species&quot;: taxalevels = &#39;s__|t__&#39; elif taxa == &quot;genus&quot;: taxalevels = &#39;g__|s__&#39; elif taxa == &quot;family&quot;: taxalevels = &#39;f__|g__&#39; elif taxa == &quot;order&quot;: taxalevels = &#39;o__|f__&#39; elif taxa == &quot;class&quot;: taxalevels = &#39;c__|o__&#39; elif taxa == &quot;phylum&quot;: taxalevels = &#39;p__|c__&#39; taxa_levels = taxalevels.split(&#39;|&#39;) if len(taxa_levels) != 2: print(&quot;please check your taxa&quot;) exit() df = pd.DataFrame() for key in filedict: temp_df = Read_File(filedict[key], key, taxa_levels, filetype) if df.empty: df = temp_df else: df = pd.merge(df, temp_df, on=&quot;taxaid&quot;, how=&#39;outer&#39;) res = df.replace(np.nan, 0) return(res) def Make_dir(dirpath): if not os.path.exists(dirpath): os.mkdir(dirpath) def main(): file = args.file out = args.out taxa = args.taxa kind = args.kind prefix = args.prefix file2dic = Filename_to_filepath(file) df_res = Merge_Metaphlan(file2dic, taxa, kind) Make_dir(out) outfile_name = out + &quot;/&quot; + prefix + &quot;.csv&quot; df_res.to_csv(outfile_name, sep=&#39;\\t&#39;, encoding=&#39;utf-8&#39;, index=False) print(&#39;Congratulations, Program Ended Without Problem&#39;) main() merging output: for example: species levels python merge_metaphlan.py \\ -f metaphlan_BJ_RoundG_filepath.tsv \\ -p metaphlan2_BJ_RoundG_merge_species \\ -t species \\ -o ./profile/ Finally, you would obtain the file integrated all the output in this project folder /share/projects/Engineering/pipeline_output/PipelineJob_141157_20220823/, and then use it to do data analysis. 2.1.2 Importing results /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/MGS/metaphlan2_merged.tsv /home/xuxiaomin/project/standardized_analytics_workflow_R_function/demo_data/MGS/metadata.txt metaphlan2_res &lt;- read.table( system.file( &quot;extdata&quot;, &quot;metaphlan2_merged.tsv&quot;, package = &quot;XMAS2&quot; ), header = TRUE, stringsAsFactors = FALSE ) metaphlan2_sam &lt;- read.table( system.file( &quot;extdata&quot;, &quot;metaphlan2_metadata.tsv&quot;, package = &quot;XMAS2&quot; ), sep = &quot;\\t&quot;, header = TRUE, stringsAsFactors = FALSE ) 2.1.3 taxa table metaphlan2_res_list &lt;- import_metaphlan_taxa(data_metaphlan2 = metaphlan2_res, taxa_level = &quot;Species&quot;) tax_tab &lt;- metaphlan2_res_list$tax_tab head(tax_tab) ## Kingdom Phylum Class Order Family Genus ## s__Actinomyces_graevenitzii k__Bacteria p__Actinobacteria c__Actinobacteria o__Actinomycetales f__Actinomycetaceae g__Actinomyces ## s__Actinomyces_johnsonii k__Bacteria p__Actinobacteria c__Actinobacteria o__Actinomycetales f__Actinomycetaceae g__Actinomyces ## s__Actinomyces_massiliensis k__Bacteria p__Actinobacteria c__Actinobacteria o__Actinomycetales f__Actinomycetaceae g__Actinomyces ## s__Actinomyces_odontolyticus k__Bacteria p__Actinobacteria c__Actinobacteria o__Actinomycetales f__Actinomycetaceae g__Actinomyces ## s__Actinomyces_oris k__Bacteria p__Actinobacteria c__Actinobacteria o__Actinomycetales f__Actinomycetaceae g__Actinomyces ## s__Actinomyces_viscosus k__Bacteria p__Actinobacteria c__Actinobacteria o__Actinomycetales f__Actinomycetaceae g__Actinomyces ## Species ## s__Actinomyces_graevenitzii s__Actinomyces_graevenitzii ## s__Actinomyces_johnsonii s__Actinomyces_johnsonii ## s__Actinomyces_massiliensis s__Actinomyces_massiliensis ## s__Actinomyces_odontolyticus s__Actinomyces_odontolyticus ## s__Actinomyces_oris s__Actinomyces_oris ## s__Actinomyces_viscosus s__Actinomyces_viscosus 2.1.4 otu table metaphlan2_res_list &lt;- import_metaphlan_taxa(data_metaphlan2 = metaphlan2_res, taxa_level = &quot;Species&quot;) otu_tab &lt;- metaphlan2_res_list$abu_tab head(otu_tab) ## s1 s2 s3 s4 s5 s6 s7 s8 s9 s10 s11 s12 s13 s14 s15 s16 s17 s18 ## s__Actinomyces_graevenitzii 3.58e-05 0 0.0e+00 0 0 0 7.20e-06 0.0e+00 0.0000000 0 1.40e-05 0e+00 0.00e+00 0.0e+00 0 0 0 6.1e-06 ## s__Actinomyces_johnsonii 0.00e+00 0 0.0e+00 0 0 0 0.00e+00 0.0e+00 0.0000000 0 0.00e+00 0e+00 1.15e-05 0.0e+00 0 0 0 0.0e+00 ## s__Actinomyces_massiliensis 0.00e+00 0 0.0e+00 0 0 0 2.95e-05 0.0e+00 0.0000000 0 0.00e+00 0e+00 0.00e+00 0.0e+00 0 0 0 0.0e+00 ## s__Actinomyces_odontolyticus 7.70e-05 0 1.7e-06 0 0 0 2.47e-05 5.8e-06 0.0001175 0 6.16e-05 0e+00 1.66e-05 3.9e-06 0 0 0 0.0e+00 ## s__Actinomyces_oris 0.00e+00 0 0.0e+00 0 0 0 2.81e-05 0.0e+00 0.0000135 0 0.00e+00 0e+00 0.00e+00 0.0e+00 0 0 0 0.0e+00 ## s__Actinomyces_viscosus 4.60e-06 0 0.0e+00 0 0 0 0.00e+00 0.0e+00 0.0000039 0 6.20e-06 7e-06 1.10e-06 0.0e+00 0 0 0 0.0e+00 ## s19 s20 s21 s22 refE ## s__Actinomyces_graevenitzii 1.60e-06 0 0 0.00e+00 0 ## s__Actinomyces_johnsonii 0.00e+00 0 0 0.00e+00 0 ## s__Actinomyces_massiliensis 0.00e+00 0 0 2.52e-05 0 ## s__Actinomyces_odontolyticus 4.19e-05 0 0 0.00e+00 0 ## s__Actinomyces_oris 0.00e+00 0 0 7.40e-06 0 ## s__Actinomyces_viscosus 0.00e+00 0 0 7.28e-05 0 2.1.5 metadata table sam_tab &lt;- metaphlan2_sam %&gt;% tibble::column_to_rownames(&quot;SampleID&quot;) head(sam_tab) ## Group phynotype ## s1 BB 0.00 ## s2 AA 2.50 ## s3 BB 0.00 ## s4 AA 1.25 ## s5 AA 30.00 ## s6 AA 15.00 2.1.6 phyloseq object metaphlan2_ps &lt;- get_metaphlan_phyloseq( otu_tab = otu_tab, sam_tab = sam_tab, tax_tab = tax_tab) metaphlan2_ps ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 322 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 322 taxa by 7 taxonomic ranks ] we obtain the phyloseq-class object and then use it to perform data analysis. Here, the phyloseq object comprises five components (OTU Table, Sample Data, and Taxonomy Table). 2.2 Transform the abundance of taxa whose relative abundance under Limit Of Detection (LOD) into Zeros metaphlan2_ps_LOD_species &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps, taxa_level = &quot;Species&quot;, cutoff = 1e-04) metaphlan2_ps_LOD_species ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 192 taxa and 23 samples ] ## sample_data() Sample Data: [ 23 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 192 taxa by 7 taxonomic ranks ] 2.3 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── References "],["quality-control.html", "Chapter 3 Quality Control 3.1 spike-in sample (BRS) 3.2 Spike-in sample’s (BRS) remove 3.3 Systematic Information", " Chapter 3 Quality Control Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) The taxonomic levels of spike-in sample’s bacteria is species. Firstly, using the summarize_taxa to get the species level phyloseq object and then do run_RefCheck under the optimal parameters. 3.1 spike-in sample (BRS) get the BRS_ID metaphlan2_ps_LOD_species &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps, taxa_level = &quot;Species&quot;, cutoff = 1e-04) metaphlan2_ps_LOD_species@sam_data ## Group phynotype ## s1 BB 0.00 ## s2 AA 2.50 ## s3 BB 0.00 ## s4 AA 1.25 ## s5 AA 30.00 ## s6 AA 15.00 ## s7 BB 8.75 ## s8 BB 0.00 ## s9 BB 3.75 ## s10 BB 2.50 ## s11 BB 15.00 ## s12 BB 2.50 ## s13 BB 2.50 ## s14 BB 0.00 ## s15 BB 1.07 ## s16 BB 2.50 ## s17 AA 5.00 ## s18 BB 35.00 ## s19 BB 7.50 ## s20 BB 15.00 ## s21 AA 3.75 ## s22 AA 3.75 ## refE QC NA run run_RefCheck2 run_RefCheck2( ps = metaphlan2_ps_LOD_species, BRS_ID = &quot;refE&quot;, Ref_type = &quot;MGS&quot;) ## Noting: the Reference Matrix is for MGS ## ## ############Matched baterica of the BRS sample############# ## The number of BRS&#39; bacteria matched the Reference Matrix is [15] ## s__Bifidobacterium_adolescentis ## s__Bifidobacterium_longum ## s__Bifidobacterium_pseudocatenulatum ## s__Collinsella_aerofaciens ## s__Bacteroides_ovatus ## s__Bacteroides_thetaiotaomicron ## s__Bacteroides_uniformis ## s__Bacteroides_vulgatus ## s__Bacteroides_xylanisolvens ## s__Prevotella_copri ## s__Streptococcus_salivarius ## s__Coprococcus_comes ## s__Dorea_formicigenerans ## s__Roseburia_hominis ## s__Faecalibacterium_prausnitzii ## The number of bacteria unmatched the Reference Matrix is [11] ## s__Propionibacterium_acnes ## s__Bifidobacterium_bifidum ## s__Eggerthella_unclassified ## s__Bacteroides_fragilis ## s__Bacteroides_intestinalis ## s__Parabacteroides_goldsteinii ## s__Enterococcus_faecalis ## s__Enterococcus_faecium ## s__Lactobacillus_pentosus ## s__Lactobacillus_salivarius ## s__Escherichia_coli ## The number of the additional bacteria compared to the Reference Matrix is [45] ## ########################################################### ## ## ##################Status of the BRS sample################## ## Whether the BRS has the all bateria of Reference Matrix: FALSE ## Correlation Coefficient of the BRS is: -0.1179 ## Bray Curtis of the BRS is: 0.8761 ## Impurity of the BRS is: 32.76 ## ########################################################### ## #####Final Evaluation Results of the BRS ####### ## The BRS of sequencing dataset didn&#39;t pass the cutoff of the Reference Matrix ## ########################################################### ## $Matrix ## 7682 7683 7684 7685 7842 7843 7844 7845 refE mean ## Propionibacterium_acnes 0.28649 0.22355 0.32199 0.28276 0.37568 0.44201 0.41135 0.39489 NA 0.30430222 ## Bifidobacterium_adolescentis 7.05611 6.28460 6.57297 6.25448 4.69357 4.80628 4.94943 4.84278 0.04649 5.05630111 ## Bifidobacterium_bifidum 1.32803 1.19346 1.26883 1.05154 1.34640 1.40471 1.43721 1.48097 NA 1.16790556 ## Bifidobacterium_longum 10.31832 9.25812 9.69184 7.76031 11.03311 11.61484 12.29030 11.69019 0.01646 9.29705444 ## Bifidobacterium_pseudocatenulatum 6.89760 6.36177 7.39605 5.76804 6.19464 6.47094 7.41615 6.27837 0.15023 5.88153222 ## Collinsella_aerofaciens 0.56189 0.53249 0.60476 0.47934 0.65513 0.68833 0.76063 0.66896 0.07251 0.55822667 ## Eggerthella_unclassified 1.21416 1.06143 1.19122 0.85743 1.36030 1.48457 1.61204 1.50700 NA 1.14312778 ## Bacteroides_fragilis 6.56752 7.19828 7.27658 7.31998 7.10174 6.70626 6.60219 6.11088 NA 6.09815889 ## Bacteroides_intestinalis 0.09448 0.09550 0.10216 0.09326 0.08448 0.09556 0.08852 0.10469 NA 0.08429444 ## Bacteroides_ovatus 3.08552 3.27226 3.10904 3.24565 3.51376 3.50063 3.37872 3.42300 0.25782 2.97626667 ## Bacteroides_thetaiotaomicron 3.24207 3.31897 3.22418 3.43809 3.35611 3.38323 3.29098 3.30355 1.47422 3.11460000 ## Bacteroides_uniformis 2.24271 2.24035 1.92015 2.18435 2.43230 2.38180 2.13830 2.41437 0.21061 2.01832667 ## Bacteroides_vulgatus 3.06672 3.20369 3.14979 3.15352 3.24822 3.09280 3.13038 3.06113 2.14684 3.02812111 ## Bacteroides_xylanisolvens 1.55687 1.84824 1.91166 1.85273 1.75220 1.74002 1.69811 1.67676 0.32466 1.59569444 ## Parabacteroides_goldsteinii 5.92564 5.95499 6.04638 5.85282 6.85811 6.50800 6.35758 6.96646 NA 5.60777556 ## Prevotella_copri 2.03757 1.99619 1.92504 2.15422 1.57638 1.60584 1.57913 1.59224 60.84109 8.36752222 ## Enterococcus_faecalis 11.46695 12.46200 11.92117 11.95884 13.71474 13.67805 13.21782 13.27297 NA 11.29917111 ## Enterococcus_faecium 4.57147 4.64943 4.52463 4.76407 5.45590 5.17641 5.15276 5.24896 NA 4.39373667 ## Lactobacillus_pentosus 0.75844 0.75524 0.72958 0.80796 0.91548 0.89940 0.81308 0.94831 NA 0.73638778 ## Lactobacillus_salivarius 4.89005 5.18462 5.12745 7.79194 2.72469 2.25673 2.10356 2.02202 NA 3.56678444 ## Streptococcus_salivarius 3.54220 3.74119 3.62036 4.01546 2.90216 2.70193 2.61760 2.57348 0.02846 2.86031556 ## Coprococcus_comes 2.28009 2.42978 2.25227 2.82904 1.21527 1.16485 1.07160 1.07834 0.01444 1.59285333 ## Dorea_formicigenerans 4.83413 5.02149 5.18268 5.56891 3.34720 3.09877 3.08677 2.70732 0.02775 3.65278000 ## Roseburia_hominis 0.04384 0.04183 0.04107 0.02304 0.03853 0.03464 0.03532 0.03597 0.01307 0.03414556 ## Faecalibacterium_prausnitzii 0.65572 0.60153 0.60112 0.62079 0.54147 0.55383 0.58806 0.54655 1.61939 0.70316222 ## Escherichia_coli 8.76957 8.33337 7.70416 8.11247 10.44118 10.33823 9.96261 11.06988 NA 8.30349667 ## Impurity_level 2.70584 2.73563 2.58287 1.75896 3.12125 4.17134 4.20980 4.97996 32.76000 6.55840556 ## Evaluation ## Propionibacterium_acnes refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bifidobacterium_adolescentis refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bifidobacterium_bifidum refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bifidobacterium_longum refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bifidobacterium_pseudocatenulatum refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Collinsella_aerofaciens refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Eggerthella_unclassified refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bacteroides_fragilis refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bacteroides_intestinalis refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bacteroides_ovatus refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bacteroides_thetaiotaomicron refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bacteroides_uniformis refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bacteroides_vulgatus refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Bacteroides_xylanisolvens refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Parabacteroides_goldsteinii refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Prevotella_copri refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Enterococcus_faecalis refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Enterococcus_faecium refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Lactobacillus_pentosus refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Lactobacillus_salivarius refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Streptococcus_salivarius refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Coprococcus_comes refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Dorea_formicigenerans refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Roseburia_hominis refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Faecalibacterium_prausnitzii refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Escherichia_coli refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## Impurity_level refE didn&#39;t pass the threshold (2023-10-27 16:59:12). ## ## $Assess ## Gold_Cutoff BRS ## Coef 0.8726 -0.1179 ## Bray 0.2064 0.8761 ## Impurity 6.4400 32.7600 3.2 Spike-in sample’s (BRS) remove metaphlan2_ps_LOD_species_remove_BRS &lt;- get_GroupPhyloseq( ps = metaphlan2_ps_LOD_species, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) metaphlan2_ps_LOD_species_remove_BRS ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 192 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 192 taxa by 7 taxonomic ranks ] 3.3 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["data-processing.html", "Chapter 4 Data processing 4.1 Extracting specific taxonomic level 4.2 Systematic Information", " Chapter 4 Data processing The corresponding XMAS2 argument is normMethod with the available options: “rarefy”, “TSS”, “TMM”, “RLE”, “CSS”, “CLR” and “CPM”. Method Approach Comments rarefy (Rarefying) Subsampling from the data to obtain samples with equal library size (also called rarefaction level) . Aims to avoid compositional effects. TSS (Total Sum Scaling) Traditional approach for building fractions. Counts are divided by the total sum of counts in the corresponding sample. Strongly influenced by highly abundant taxa. TMM (Trimmed Mean of M-values) First, a sample is chosen as reference. The scaling factor is then derived using a weighted trimmed mean over the differences of the log-transformed gene-count fold-change between the sample and the reference. Aims to avoid sequencing depth effects. RLE (Relative Log Expression ) RLE uses a pseudo-reference calculated using the geometric mean of the gene-specific abundances over all samples. The scaling factors are then calculated as the median of the gene counts ratios between the samples and the reference. Similar to TMM, this normalization method is based on the hypothesis that the most genes are not DE. CSS (Cumulative Sum Scaling) Within each sample, the counts are summed up to a predefined quantile. The counts are then divided by this sum. Aims at avoiding the influence of highly abundant taxa. CLR (Centered log-ratio transformation) For a composition \\[x = (x_{1} , ..., x_{p})\\] the clr transformation is defined as \\[clr = log(\\frac{x_{1}}{g(x)}, ..., \\frac{x_{p}}{g(x)})\\], where \\[g(x)=(\\prod_{p}^{k=1} x_{k})^{\\frac{1}{p}}\\] is the geometric mean. Aims to avoid compositional effects. CPM (Counts Per Million) pre-sample normalization of the sum of the values to 1e+06. Aims to avoid sequencing depth effects. Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) This part has too may procedures and we only choose some of them. Please go to XMAS tutorial: Chapter 6 to see more approaches and details for being familiar with this part. 4.1 Extracting specific taxonomic level Removing spike-in sample (BRS) metaphlan2_ps_remove_BRS &lt;- get_GroupPhyloseq( ps = metaphlan2_ps, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) metaphlan2_ps_LOD_species_remove_BRS ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 192 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 192 taxa by 7 taxonomic ranks ] Species metaphlan2_ps_LOD_species &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps_remove_BRS, taxa_level = &quot;Species&quot;, cutoff = 1e-04) metaphlan2_ps_LOD_species ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 190 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 190 taxa by 7 taxonomic ranks ] Genus metaphlan2_ps_LOD_genus &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps_remove_BRS, taxa_level = &quot;Genus&quot;, cutoff = 1e-04) metaphlan2_ps_LOD_genus ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 66 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 66 taxa by 6 taxonomic ranks ] Phylum metaphlan2_ps_LOD_phylum &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps_remove_BRS, taxa_level = &quot;Phylum&quot;, cutoff = 1e-04) metaphlan2_ps_LOD_phylum ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 7 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 7 taxa by 2 taxonomic ranks ] Finally, we obtained the final phyloseq-class object. 4.2 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["diversity-analysis.html", "Chapter 5 Diversity analysis 5.1 Alpha diveristy 5.2 Beta diversity 5.3 Systematic Information", " Chapter 5 Diversity analysis Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) 5.1 Alpha diveristy Calculate the alpha diversity Notes: choosing the measures (Shannon, Simpson and InvSimpson) only for relative abundance. metaphlan2_ps_LOD_species_alpha &lt;- run_alpha_diversity(ps = metaphlan2_ps_LOD_species, measures = c(&quot;Shannon&quot;, &quot;Simpson&quot;, &quot;InvSimpson&quot;)) DT::datatable(metaphlan2_ps_LOD_species_alpha) visualization plot_boxplot(data = metaphlan2_ps_LOD_species_alpha, y_index = c(&quot;Shannon&quot;, &quot;Simpson&quot;, &quot;InvSimpson&quot;), group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), group_color = c(&quot;red&quot;, &quot;blue&quot;), do_test = TRUE, method = &quot;wilcox.test&quot;) Figure 5.1: Alpha diversity 5.2 Beta diversity beta dipersion metaphlan2_ps_LOD_beta &lt;- run_beta_diversity(ps = metaphlan2_ps_LOD_species, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.003162 0.0031624 0.4485 999 0.514 ## Residuals 20 0.141034 0.0070517 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## AA BB ## AA 0.512 ## BB 0.51072 metaphlan2_ps_LOD_beta$BetaDispersion Figure 5.2: Beta diversity 5.3 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["permanova-beta-dispersion-ordination.html", "Chapter 6 PERMANOVA + beta dispersion + Ordination 6.1 PERMANOVA 6.2 beta dispersion 6.3 Ordination 6.4 Systematic Information", " Chapter 6 PERMANOVA + beta dispersion + Ordination Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) 6.1 PERMANOVA metaphlan2_ps_LOD_species_per &lt;- run_permanova(ps = metaphlan2_ps_LOD_species, method = &quot;bray&quot;, columns = &quot;Group&quot;) print(metaphlan2_ps_LOD_species_per) ## SumsOfSample Df SumsOfSqs MeanSqs F.Model R2 Pr(&gt;F) AdjustedPvalue ## Group 22 1 0.8017593 0.8017593 2.564587 0.1136554 0.002 0.002 The PERMANOVA result of the Group (AdjustedPvalue &gt; 0.05) revealed that the two groups had not the distinct patterns of microbial community. 6.2 beta dispersion beta_df &lt;- run_beta_diversity(ps = metaphlan2_ps_LOD_species, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.003162 0.0031624 0.4485 999 0.514 ## Residuals 20 0.141034 0.0070517 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## AA BB ## AA 0.512 ## BB 0.51072 6.3 Ordination We performed ordination by using Principal Coordinate Analysis (PCoA). metaphlan2_ps_species_ordination &lt;- run_ordination( ps = metaphlan2_ps_LOD_species, group = &quot;Group&quot;, method = &quot;PCoA&quot;) # plot_Ordination(ResultList = metaphlan2_ps_species_ordination, # group = &quot;Group&quot;, # group_names = c(&quot;AA&quot;, &quot;BB&quot;), # group_color = c(&quot;blue&quot;, &quot;red&quot;), # circle_type = &quot;ellipse_groups&quot;, # sidelinechart = FALSE, # sideboxplot = TRUE) plot_Ordination(ResultList = metaphlan2_ps_species_ordination, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), group_color = c(&quot;blue&quot;, &quot;red&quot;)) Figure 6.1: PCoA 6.4 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["microbial-composition.html", "Chapter 7 Microbial composition 7.1 Stacked barplot 7.2 Core microbiota 7.3 Systematic Information", " Chapter 7 Microbial composition Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) A whole picture of the microbial composition. 7.1 Stacked barplot XVIZ package plot_stacked_bar_XIVZ( phyloseq = metaphlan2_ps_LOD_species, level = &quot;Phylum&quot;, feature = &quot;Group&quot;) Figure 7.1: Microbial composition in XVIZ XMAS package plot_StackBarPlot( ps = metaphlan2_ps_LOD_species, taxa_level = &quot;Phylum&quot;, group = &quot;Group&quot;, cluster = TRUE) ## [1] &quot;This palatte have 20 colors!&quot; Figure 7.2: Microbial composition 7.2 Core microbiota prevalences &lt;- seq(0.05, 1, 0.05) detections &lt;- 10^seq(log10(1e-3), log10(0.2), length = 10) pl_core &lt;- plot_core_taxa(metaphlan2_ps_LOD_species, plot.type = &quot;heatmap&quot;, colours = gray(seq(0, 1, length=5)), prevalences = prevalences, detections = detections, min.prevalence = 0.5)+ xlab(&quot;Detection Threshold (Relative Abundance (%))&quot;) pl_core Figure 7.3: Core taxa The degree of color indicates the size of abundance and prevalence. Use core_members to obtain the core taxa. detection for abundance and prevalence for occurrence. core_taxa_name &lt;- core_members(metaphlan2_ps_LOD_species, detection = 0.01, prevalence = 0.5) print(core_taxa_name) ## [1] &quot;s__Bacteroides_uniformis&quot; &quot;s__Bacteroides_vulgatus&quot; &quot;s__Faecalibacterium_prausnitzii&quot; &quot;s__Ruminococcus_sp_5_1_39BFAA&quot; Result: Only 4 genera (s__Bacteroides_uniformis, s__Bacteroides_vulgatus, s__Faecalibacterium_prausnitzii and s__Ruminococcus_sp_5_1_39BFAA) passed the threshold of detection and prevalence which we choose. 7.3 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["differential-analysis.html", "Chapter 8 Differential Analysis 8.1 Filtering &amp; Trimming 8.2 Liner discriminant analysis (LDA) effect size (LEfSe) 8.3 Wilcoxon Rank-Sum test 8.4 Dominant taxa 8.5 Multiple differential analysis by one function 8.6 Systematic Information", " Chapter 8 Differential Analysis Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) There are more than 10 approaches to perform differential analysis. Here, we choose two of them and recommend users going to Chapter 10 to see more details. 8.1 Filtering &amp; Trimming We suggest that filtering taxa with low abundance (the summarized value under cutoff: 1e-4) and trimming taxa with low prevalence (default: 0.1). 8.1.1 Filtering the low relative abundance or unclassified taxa by the threshold (total counts &lt; 1e-4) filter by sum relative abundance metaphlan2_ps_species_filter &lt;- run_filter(ps = metaphlan2_ps_LOD_species_remove_BRS, cutoff = 1e-4, unclass = TRUE) metaphlan2_ps_species_filter ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 144 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 144 taxa by 7 taxonomic ranks ] filter by following two criterion (Thingholm et al. 2019) Species from taxonomic profiles were retained for further analysis if their mean relative abundance exceeded 0.005 (0.5%) across the dataset with a minimum abundance of 0.05 (5%) in at least one sample and non-zero abundance in at least 60% of samples. Mean relative abundance: 0.005; Minimum relative abundance: 0.05; Here, we use 0.01 (the 1e-4 regarded as 0.01 compared to the Referece because Metaphlan2 data had been divided 100). metaphlan2_ps_species_filter2 &lt;- run_filter2(ps = metaphlan2_ps_LOD_species_remove_BRS, cutoff_mean = 1e-04, cutoff_one = 1e-03, unclass = TRUE) metaphlan2_ps_species_filter2 ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 144 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 144 taxa by 7 taxonomic ranks ] 8.1.2 Trimming the taxa with low occurrence less than threshold metaphlan2_ps_species_filter_trim &lt;- run_trim(object = metaphlan2_ps_species_filter, cutoff = 0.1, trim = &quot;feature&quot;) metaphlan2_ps_species_filter_trim ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 132 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 132 taxa by 7 taxonomic ranks ] 8.2 Liner discriminant analysis (LDA) effect size (LEfSe) Calculation # metaphlan2_ps_lefse &lt;- run_lefse( # ps = metaphlan2_ps_species_filter_trim, # group = &quot;Group&quot;, # group_names = c(&quot;AA&quot;, &quot;BB&quot;), # norm = &quot;CPM&quot;, # Lda = 2) metaphlan2_ps_lefse &lt;- run_lefse2( ps = metaphlan2_ps_species_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), norm = &quot;CPM&quot;, lda_cutoff = 2) head(metaphlan2_ps_lefse) ## TaxaID Block LDA_Score Enrichment EffectSize Pvalue Log2FoldChange (Median)\\nAA_vs_BB ## 1 s__Adlercreutzia_equolifaciens 7_AA vs 15_BB 3.160778 BB 1.577193 0.03675238 NA ## 2 s__Bacteroides_thetaiotaomicron 7_AA vs 15_BB -4.688237 AA 4.204038 0.00531109 5.419566 ## 3 s__Bifidobacterium_adolescentis 7_AA vs 15_BB 4.755989 BB 3.883638 0.01273201 NA ## 4 s__Bifidobacterium_longum 7_AA vs 15_BB 4.764078 BB 2.466823 0.02596373 -4.652794 ## 5 s__Clostridium_asparagiforme 7_AA vs 15_BB -2.999903 AA 1.604847 0.03886151 NA ## 6 s__Collinsella_aerofaciens 7_AA vs 15_BB 4.214636 BB 3.122592 0.03312054 NA ## Median Abundance\\n(All) Median Abundance\\nAA Median Abundance\\nBB Log2FoldChange (Mean)\\nAA_vs_BB Mean Abundance\\n(All) Mean Abundance\\nAA ## 1 0.000 0.0000 0.000 NA 908.0076 0.000 ## 2 2879.516 46627.3399 1089.403 3.196193 24165.2943 61556.260 ## 3 0.000 0.0000 3849.789 NA 36307.7414 0.000 ## 4 11054.184 1204.0647 30288.685 -3.714249 41325.0829 4459.348 ## 5 0.000 267.2502 0.000 4.254960 502.7677 1420.679 ## 6 7749.743 0.0000 13231.406 -3.238523 12772.4540 1891.272 ## Mean Abundance\\nBB Occurrence (100%)\\n(All) Occurrence (100%)\\nAA Occurrence (100%)\\nBB Odds Ratio (95% CI) ## 1 1331.745 31.82 0.00 46.67 &lt;NA&gt; ## 2 6716.177 86.36 100.00 80.00 0.062 (-5.4;5.5) ## 3 53251.354 40.91 0.00 60.00 &lt;NA&gt; ## 4 58529.092 81.82 71.43 86.67 260 (270;250) ## 5 74.409 27.27 57.14 13.33 0.0067 (-9.8;9.8) ## 6 17850.339 63.64 42.86 73.33 30 (37;23) Visualization # # don&#39;t run this code when you do lefse in reality # metaphlan2_ps_lefse$LDA_Score &lt;- metaphlan2_ps_lefse$LDA_Score * 1000 plot_lefse( da_res = metaphlan2_ps_lefse, x_index = &quot;LDA_Score&quot;, x_index_cutoff = 1, group_color = c(&quot;green&quot;, &quot;red&quot;)) Figure 8.1: Lefse analysis how to plot cladogram using lefse results to see cladogram lefse 8.3 Wilcoxon Rank-Sum test Calculation metaphlan2_ps_wilcox &lt;- run_wilcox( ps = metaphlan2_ps_species_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;)) head(metaphlan2_ps_wilcox) ## TaxaID Block Enrichment EffectSize Statistic Pvalue AdjustedPvalue Log2FoldChange (Median)\\nAA_vs_BB ## 1 s__Acidaminococcus_fermentans 7_AA vs 15_BB Nonsignif 0.1545096 49.0 0.75333110 0.9039973 NA ## 2 s__Acidaminococcus_intestini 7_AA vs 15_BB Nonsignif 0.1177459 54.0 0.90599343 0.9722856 NA ## 3 s__Adlercreutzia_equolifaciens 7_AA vs 15_BB Nonsignif 1.6614672 28.0 0.04076802 0.3520563 NA ## 4 s__Alistipes_finegoldii 7_AA vs 15_BB Nonsignif 0.2935476 75.0 0.08188173 0.4793154 NA ## 5 s__Alistipes_indistinctus 7_AA vs 15_BB Nonsignif 0.3308118 68.0 0.17792767 0.4793154 NA ## 6 s__Alistipes_onderdonkii 7_AA vs 15_BB Nonsignif 0.3147638 66.5 0.29869756 0.5730690 NA ## Median Abundance\\n(All) Median Abundance\\nAA Median Abundance\\nBB Log2FoldChange (Rank)\\nAA_vs_BB Mean Rank Abundance\\nAA ## 1 0 0.0000000 0 -0.09269949 11.00 ## 2 0 0.0000000 0 0.03870725 11.71 ## 3 0 0.0000000 0 -0.71479501 8.00 ## 4 0 0.0027362 0 0.55679725 14.71 ## 5 0 0.0000000 0 0.38896713 13.71 ## 6 0 0.0002823 0 0.35298403 13.50 ## Mean Rank Abundance\\nBB Occurrence (100%)\\n(All) Occurrence (100%)\\nAA Occurrence (100%)\\nBB Odds Ratio (95% CI) ## 1 11.73 18.18 14.29 20.00 1.5 (2.4;0.69) ## 2 11.40 13.64 14.29 13.33 0.62 (-0.32;1.6) ## 3 13.13 31.82 0.00 46.67 &lt;NA&gt; ## 4 10.00 40.91 57.14 33.33 0.0025 (-12;12) ## 5 10.47 27.27 42.86 20.00 0.0085 (-9.3;9.4) ## 6 10.57 45.45 57.14 40.00 0.37 (-1.6;2.3) Volcano plot_volcano( da_res = metaphlan2_ps_wilcox, group_names = c(&quot;AA&quot;, &quot;BB&quot;), x_index = &quot;Log2FoldChange (Rank)\\nAA_vs_BB&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, group_color = c(&quot;red&quot;, &quot;grey&quot;, &quot;blue&quot;), topN = 4, taxa_name = &quot;s__Megamonas_rupellensis&quot;) Figure 8.2: Wilcoxon Rank-Sum test 8.4 Dominant taxa Display the significant taxa with selection using boxplot. plot_topN_boxplot( ps = metaphlan2_ps_species_filter_trim, da_res = metaphlan2_ps_wilcox, x_index = &quot;Log2FoldChange (Rank)\\nAA_vs_BB&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, topN = 4, group = &quot;Group&quot;) Figure 8.3: Dominant Taxa 8.5 Multiple differential analysis by one function Here, we provide the run_multiple_da for obtaining the results list from multiple differential analysis methods. multiple_res &lt;- run_multiple_da( ps = metaphlan2_ps_species_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;AA&quot;, &quot;BB&quot;), da_method = c(&quot;wilcox&quot;, &quot;limma_voom&quot;, &quot;ttest&quot;)) names(multiple_res) ## [1] &quot;wilcox&quot; &quot;limma_voom&quot; &quot;ttest&quot; plot results plot_multiple_DA( Multip_DA_res = multiple_res, x_index_list = c(&quot;Log2FoldChange (Rank)\\nAA_vs_BB&quot;, &quot;logFC&quot;, &quot;Log2FoldChange (Mean)\\nAA_vs_BB&quot;), x_index_cutoff = 0, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, cellwidth = 35, cellheight = 10, fontsize_number = 15) 8.6 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── References "],["network-analysis.html", "Chapter 9 Network Analysis 9.1 Importing data 9.2 Single network with Pearson correlation as association measure 9.3 Dissimilarity-based Networks 9.4 Systematic Information", " Chapter 9 Network Analysis Estimating microbial association networks from high-throughput sequencing data is a common exploratory data analysis approach aiming at understanding the complex interplay of microbial communities in their natural habitat. Statistical network estimation workflows comprise several analysis steps, including methods for zero handling, data normalization and computing microbial associations. Since microbial interactions are likely to change between conditions, e.g. between healthy individuals and patients, identifying network differences between groups is often an integral secondary analysis step. NetCoMi (Network Construction and Comparison for Microbiome Data) (Peschel et al. 2021) provides functionality for constructing, analyzing, and comparing networks suitable for the application on microbial compositional data. The following information is from NetCoMi github. Association measures: Pearson coefficient (cor() from stats package) Spearman coefficient (cor() from stats package) Biweight Midcorrelation bicor() from WGCNA package SparCC (sparcc() from SpiecEasi package) CCLasso (R code on GitHub) CCREPE (ccrepe package) SpiecEasi (SpiecEasi package) SPRING (SPRING package) gCoda (R code on GitHub) propr (propr package) Dissimilarity measures: Euclidean distance (vegdist() from vegan package) Bray-Curtis dissimilarity (vegdist() from vegan package) Kullback-Leibler divergence (KLD) (KLD() from LaplacesDemon package) Jeffrey divergence (own code using KLD() from LaplacesDemon package) Jensen-Shannon divergence (own code using KLD() from LaplacesDemon package) Compositional KLD (own implementation following [Martín-Fernández et al., 1999]) Aitchison distance (vegdist() and clr() from SpiecEasi package) Methods for zero replacement: Adding a predefined pseudo count Multiplicative replacement (multRepl from zCompositions package) Modified EM alr-algorithm (lrEM from zCompositions package) Bayesian-multiplicative replacement (cmultRepl from zCompositions package) Normalization methods: Total Sum Scaling (TSS) (own implementation) Cumulative Sum Scaling (CSS) (cumNormMat from metagenomeSeq package) Common Sum Scaling (COM) (own implementation) Rarefying (rrarefy from vegan package) Variance Stabilizing Transformation (VST) (varianceStabilizingTransformation from DESeq2 package) Centered log-ratio (clr) transformation (clr() from SpiecEasi package)) TSS, CSS, COM, VST, and the clr transformation are described in [Badri et al., 2020]. Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(NetCoMi) 9.1 Importing data metaphlan2_ps_remove_BRS &lt;- get_GroupPhyloseq( ps = metaphlan2_ps, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) metaphlan2_ps_genus &lt;- summarize_taxa(ps = metaphlan2_ps_remove_BRS, taxa_level = &quot;Genus&quot;) metaphlan2_ps_genus_filter &lt;- run_filter(ps = metaphlan2_ps_genus, cutoff = 1e-4, unclass = TRUE) metaphlan2_ps_genus_filter ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 51 taxa and 22 samples ] ## sample_data() Sample Data: [ 22 samples by 2 sample variables ] ## tax_table() Taxonomy Table: [ 51 taxa by 6 taxonomic ranks ] 9.2 Single network with Pearson correlation as association measure Since Pearson correlations may lead to compositional effects when applied to sequencing data, we use the clr transformation as normalization method. Zero treatment is necessary in this case. A threshold of 0.3 is used as sparsification method, so that only OTUs with an absolute correlation greater than or equal to 0.3 are connected. 9.2.1 Building network model net_single &lt;- netConstruct(metaphlan2_ps_genus_filter, measure = &quot;pearson&quot;, normMethod = &quot;none&quot;, zeroMethod = &quot;multRepl&quot;, sparsMethod = &quot;threshold&quot;, thresh = 0.7, verbose = 3, seed = 123) 9.2.2 Analyzing the constructed network NetCoMi’s netAnalyze() function is used for analyzing the constructed network(s). props_single &lt;- netAnalyze(net_single, clustMethod = &quot;cluster_fast_greedy&quot;) summary(props_single, numbNodes = 5L) ## ## Component sizes ## ``````````````` ## size: 6 4 3 2 1 ## #: 1 1 2 6 23 ## ______________________________ ## Global network properties ## ````````````````````````` ## Largest connected component (LCC): ## ## Relative LCC size 0.11765 ## Clustering coefficient 0.59409 ## Modularity 0.12245 ## Positive edge percentage 100.00000 ## Edge density 0.46667 ## Natural connectivity 0.38192 ## Vertex connectivity 1.00000 ## Edge connectivity 1.00000 ## Average dissimilarity* 0.67983 ## Average path length** 0.76641 ## ## Whole network: ## ## Number of components 33.00000 ## Clustering coefficient 0.69803 ## Modularity 0.83058 ## Positive edge percentage 100.00000 ## Edge density 0.01725 ## Natural connectivity 0.02661 ## ## *Dissimilarity = 1 - edge weight ## **Path length: Units with average dissimilarity ## ## ______________________________ ## Clusters ## - In the whole network ## - Algorithm: cluster_fast_greedy ## ```````````````````````````````` ## ## name: 0 1 2 3 4 5 6 7 8 9 10 ## #: 23 6 4 2 2 2 3 2 2 2 3 ## ## ______________________________ ## Hubs ## - In alphabetical/numerical order ## - Based on empirical quantiles of centralities ## ``````````````````````````````````````````````` ## g__Alistipes ## g__Holdemania ## g__Proteus ## ## ______________________________ ## Centrality measures ## - In decreasing order ## - Centrality of disconnected components is zero ## ```````````````````````````````````````````````` ## Degree (normalized): ## ## g__Proteus 0.08 ## g__Alistipes 0.06 ## g__Holdemania 0.06 ## g__Flavonifractor 0.04 ## g__Enterococcus 0.02 ## ## Betweenness centrality (normalized): ## ## g__Proteus 0.6 ## g__Alistipes 0.4 ## g__Acidaminococcus 0.0 ## g__Adlercreutzia 0.0 ## g__Akkermansia 0.0 ## ## Closeness centrality (normalized): ## ## g__Proteus 2.21621 ## g__Holdemania 1.91300 ## g__Alistipes 1.71565 ## g__Flavonifractor 1.35153 ## g__Enterococcus 1.19617 ## ## Eigenvector centrality (normalized): ## ## g__Proteus 1.00000 ## g__Holdemania 0.88889 ## g__Alistipes 0.76367 ## g__Flavonifractor 0.64535 ## g__Enterococcus 0.33917 9.2.3 Visualizing the network primary plot plot(props_single, nodeColor = &quot;cluster&quot;, nodeSize = &quot;eigenvector&quot;, title1 = &quot;Network on 16s with Pearson correlations&quot;, showTitle = TRUE, labelLength = 10, cexTitle = 1.5) legend(0.7, 1.1, cex = 1, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;#009900&quot;,&quot;red&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.1: Network on 16s with Pearson correlations improve the visualization by changing the following arguments: repulsion = 0.8: Place the nodes further apart rmSingles = TRUE: Single nodes are removed labelScale = FALSE and cexLabels = 1.6: All labels have equal size and are enlarged to improve readability of small node’s labels nodeSizeSpread = 3 (default is 4): Node sizes are more similar if the value is decreased. This argument (in combination with cexNodes) is useful to enlarge small nodes while keeping the size of big nodes. plot(props_single, nodeColor = &quot;cluster&quot;, nodeSize = &quot;eigenvector&quot;, labelLength = 40, repulsion = 0.8, rmSingles = TRUE, labelScale = FALSE, cexLabels = 1, nodeSizeSpread = 3, cexNodes = 2, title1 = &quot;Network on metabolomics with Pearson correlations&quot;, showTitle = TRUE, cexTitle = 1.5) legend(0.7, 1.1, cex = 1.2, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;#009900&quot;,&quot;red&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.2: Network on 16s with Pearson correlations Network on genus level with Pearson correlations set.seed(123) graph &lt;- igraph::graph_from_adjacency_matrix(net_single$adjaMat1, weighted = TRUE) lay_fr &lt;- igraph::layout_with_fr(graph) rownames(lay_fr) &lt;- rownames(net_single$adjaMat1) plot(props_single, layout = &quot;layout_with_fr&quot;, shortenLabels = &quot;simple&quot;, labelLength = 30, charToRm = &quot;g__&quot;, labelScale = FALSE, rmSingles = TRUE, nodeSize = &quot;clr&quot;, nodeColor = &quot;cluster&quot;, hubBorderCol = &quot;darkgray&quot;, cexNodes = 2, cexLabels = 1.5, cexHubLabels = 2, title1 = &quot;Network on genus level with Pearson correlations&quot;, showTitle = TRUE, cexTitle = 2.3) legend(0.7, 1.1, cex = 2.2, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;#009900&quot;,&quot;red&quot;), bty = &quot;n&quot;, horiz = TRUE) Figure 9.3: Network on 16s with Pearson correlations (Genus) Let’s check whether the largest nodes are actually those with highest column sums in the matrix with normalized counts returned by netConstruct(). sort(colSums(net_single$normCounts1), decreasing = TRUE)[1:10] ## g__Bacteroides g__Bifidobacterium g__Prevotella g__Eubacterium g__Faecalibacterium g__Streptococcus g__Ruminococcus ## 6.2673586 2.3606139 2.0131275 1.2915922 1.2683941 0.8139481 0.7899226 ## g__Megamonas g__Blautia g__Lactobacillus ## 0.7171101 0.5348218 0.4701121 Network on genus level with Pearson correlations with phylum annotation if (FALSE) { # Get phyla names from the taxonomic table created before taxatab &lt;- metaphlan2_ps_genus_filter@tax_table %&gt;% data.frame() phyla &lt;- as.factor(gsub(&quot;p__&quot;, &quot;&quot;, taxatab[, &quot;Phylum&quot;])) names(phyla) &lt;- taxatab$Genus # Define phylum colors phylcol &lt;- c(&quot;cyan&quot;, &quot;blue3&quot;, &quot;red&quot;, &quot;lawngreen&quot;, &quot;yellow&quot;, &quot;deeppink&quot;, &quot;grey&quot;, &quot;black&quot;, &quot;green&quot;) plot(props_single, layout = &quot;spring&quot;, repulsion = 0.84, shortenLabels = &quot;none&quot;, charToRm = &quot;g__&quot;, labelLength = 30, labelScale = FALSE, rmSingles = TRUE, nodeSize = &quot;clr&quot;, nodeSizeSpread = 4, nodeColor = &quot;feature&quot;, featVecCol = phyla, colorVec = phylcol, posCol = &quot;darkturquoise&quot;, negCol = &quot;orange&quot;, edgeTranspLow = 0, edgeTranspHigh = 40, cexNodes = 2, cexLabels = 2, cexHubLabels = 2.5, title1 = &quot;Network on genus level with Pearson correlations&quot;, showTitle = TRUE, cexTitle = 2.3) # Colors used in the legend should be equally transparent as in the plot phylcol_transp &lt;- NetCoMi:::colToTransp(phylcol, 60) legend(-1.2, 1.2, cex = 2, pt.cex = 2.5, title = &quot;Phylum:&quot;, legend=levels(phyla), col = phylcol_transp, bty = &quot;n&quot;, pch = 16) legend(0.7, 1.1, cex = 2.2, title = &quot;estimated correlation:&quot;, legend = c(&quot;+&quot;,&quot;-&quot;), lty = 1, lwd = 3, col = c(&quot;darkturquoise&quot;,&quot;orange&quot;), bty = &quot;n&quot;, horiz = TRUE) } 9.3 Dissimilarity-based Networks If a dissimilarity measure is used for network construction, nodes are subjects instead of OTUs. The estimated dissimilarities are transformed into similarities, which are used as edge weights so that subjects with a similar microbial composition are placed close together in the network plot. We construct a single network using Aitchison’s distance being suitable for the application on compositional data. Since the Aitchison distance is based on the clr-transformation, zeros in the data need to be replaced. The network is sparsified using the k-nearest neighbor (knn) algorithm. 9.3.1 Building network module net_aitchison &lt;- netConstruct(metaphlan2_ps_genus_filter, measure = &quot;aitchison&quot;, zeroMethod = &quot;multRepl&quot;, sparsMethod = &quot;knn&quot;, kNeighbor = 3, verbose = 3) ## Infos about changed arguments: ## Counts normalized to fractions for measure &#39;aitchison&#39;. ## 51 taxa and 22 samples remaining. ## ## Zero treatment: ## Execute multRepl() ... ## Warning in (function (X, label = NULL, dl = NULL, frac = 0.65, imp.missing = FALSE, : Column(s) containing more than 80% zeros/unobserved values were found (check it out using zPatterns). ## (You can use the z.warning argument to modify the warning threshold). ## Done. ## ## Normalization: ## Counts normalized by total sum scaling. ## ## Calculate &#39;aitchison&#39; dissimilarities ... Done. ## ## Sparsify dissimilarities via &#39;knn&#39; ... Done. 9.3.2 Analyzing the constructed network NetCoMi’s netAnalyze() function is used for analyzing the constructed network(s). props_aitchison &lt;- netAnalyze(net_aitchison, clustMethod = &quot;hierarchical&quot;, clustPar = list(method = &quot;average&quot;, k = 3), hubPar = &quot;eigenvector&quot;) summary(props_aitchison, numbNodes = 5L) ## ## Component sizes ## ``````````````` ## size: 22 ## #: 1 ## ______________________________ ## Global network properties ## ````````````````````````` ## ## Number of components 1.00000 ## Clustering coefficient 0.32105 ## Modularity 0.27275 ## Positive edge percentage 100.00000 ## Edge density 0.20346 ## Natural connectivity 0.13451 ## Vertex connectivity 2.00000 ## Edge connectivity 3.00000 ## Average dissimilarity* 0.84117 ## Average path length** 0.53694 ## ## *Dissimilarity = 1 - edge weight ## **Path length: Units with average dissimilarity ## ## ______________________________ ## Clusters ## - In the whole network ## - Algorithm: hierarchical ## ````````````````````````` ## ## name: 1 2 3 ## #: 13 5 4 ## ## ______________________________ ## Hubs ## - In alphabetical/numerical order ## - Based on empirical quantiles of centralities ## ``````````````````````````````````````````````` ## s10 ## s7 ## ## ______________________________ ## Centrality measures ## - In decreasing order ## - Computed for the complete network ## ```````````````````````````````````` ## Degree (normalized): ## ## s10 0.47619 ## s7 0.42857 ## s8 0.33333 ## s12 0.28571 ## s16 0.23810 ## ## Betweenness centrality (normalized): ## ## s10 0.37143 ## s7 0.23333 ## s8 0.19524 ## s20 0.15238 ## s6 0.09524 ## ## Closeness centrality (normalized): ## ## s20 3.78684 ## s10 3.70033 ## s8 3.36495 ## s14 3.34778 ## s7 3.30724 ## ## Eigenvector centrality (normalized): ## ## s7 1.00000 ## s10 0.93516 ## s8 0.74209 ## s12 0.68679 ## s22 0.65236 9.3.3 Visualizing the network primary plot plot(props_aitchison, nodeColor = &quot;cluster&quot;, nodeSize = &quot;eigenvector&quot;, repulsion = 0.8, rmSingles = TRUE, labelScale = FALSE, cexLabels = 1.6, nodeSizeSpread = 3, cexNodes = 1.5, title1 = &quot;Network on metagenomics with Aitchison distance&quot;, showTitle = TRUE, cexTitle = 1.5, hubTransp = 50, edgeTranspLow = 60, charToRm = &quot;00000&quot;, mar = c(1, 3, 3, 5)) # get green color with 50% transparency green2 &lt;- colToTransp(&quot;#009900&quot;, 40) legend(0.4, 1.1, cex = 1.5, legend = c(&quot;high similarity (low Aitchison distance)&quot;, &quot;low similarity (high Aitchison distance)&quot;), lty = 1, lwd = c(3, 1), col = c(&quot;darkgreen&quot;, green2), bty = &quot;n&quot;) Figure 9.4: Dissimilarity-based Networks plot samples with group information # Get gorup names from the sample table created before sampletab &lt;- metaphlan2_ps_genus_filter@sam_data %&gt;% data.frame() group_labels &lt;- factor(sampletab$Group) names(group_labels) &lt;- rownames(sampletab) # Define group colors group_lcol &lt;- c(&quot;blue3&quot;, &quot;red&quot;) plot(props_aitchison, layout = &quot;spring&quot;, repulsion = 0.84, shortenLabels = &quot;none&quot;, labelScale = FALSE, rmSingles = TRUE, nodeSize = &quot;eigenvector&quot;, nodeSizeSpread = 4, nodeColor = &quot;feature&quot;, featVecCol = group_labels, colorVec = group_lcol, posCol = &quot;darkturquoise&quot;, negCol = &quot;orange&quot;, edgeTranspLow = 0, edgeTranspHigh = 40, cexNodes = 2, cexLabels = 2, cexHubLabels = 2.5, title1 = &quot;Network on genus level with Aitchison distance&quot;, showTitle = TRUE, cexTitle = 2.3) # Colors used in the legend should be equally transparent as in the plot group_transp &lt;- NetCoMi:::colToTransp(group_lcol, 60) legend(-1.2, 1.2, cex = 2, pt.cex = 2.5, title = &quot;Group:&quot;, legend = levels(group_labels), col = group_transp, bty = &quot;n&quot;, pch = 16) # get green color with 50% transparency green2 &lt;- colToTransp(&quot;#009900&quot;, 40) legend(0.4, 1.1, cex = 1.5, legend = c(&quot;high similarity (low Aitchison distance)&quot;, &quot;low similarity (high Aitchison distance)&quot;), lty = 1, lwd = c(3, 1), col = c(&quot;darkgreen&quot;, green2), bty = &quot;n&quot;) Figure 9.5: Dissimilarity-based Networks (group information) 9.4 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── References "],["test-example.html", "Chapter 10 Test Example 10.1 Loading packages 10.2 Loading data 10.3 Step1: Convert inputs into phyloseq data 10.4 Step2: Transform limit of detection (LOD) into Zeros 10.5 Step3: BRS checking 10.6 Step4: Extracting specific taxonomic level 10.7 Step5: GlobalView 10.8 Step6: Differential Analysis 10.9 Systematic Information", " Chapter 10 Test Example 10.1 Loading packages library(XMAS2) library(dplyr) library(tibble) library(phyloseq) library(ggplot2) library(ggpubr) library(readxl) 10.2 Loading data metaphlan2_res &lt;- read.table(&quot;DataSet/RawData/merged_metaphlan2.tsv&quot;, header = TRUE, stringsAsFactors = FALSE) %&gt;% tibble::rownames_to_column(&quot;ID&quot;) metadata &lt;- readxl::read_xlsx(&quot;DataSet/RawData/诺禾宏基因组678月-ZH.xlsx&quot;, sheet = 3) 10.3 Step1: Convert inputs into phyloseq data metaphlan2_res_list &lt;- import_metaphlan_taxa(data_metaphlan2 = metaphlan2_res, taxa_level = &quot;Species&quot;) tax_tab &lt;- metaphlan2_res_list$tax_tab otu_tab &lt;- metaphlan2_res_list$abu_tab colnames(otu_tab) &lt;- gsub(&quot;X&quot;, &quot;S_&quot;, colnames(otu_tab)) sam_tab &lt;- metadata %&gt;% data.frame() %&gt;% dplyr::mutate(Group=ifelse(SampleType == &quot;粪便&quot;, &quot;Stool&quot;, ifelse(SampleType == &quot;QC&quot;, &quot;QC&quot;, &quot;Product&quot;))) %&gt;% dplyr::select(SampleTubeID, Group, everything()) rownames(sam_tab) &lt;- paste0(&quot;S_&quot;, sam_tab$SeqID_MGS) overlap_samples &lt;- dplyr::intersect(rownames(sam_tab), colnames(otu_tab)) otu_tab_cln &lt;- otu_tab[, match(overlap_samples, colnames(otu_tab))] sam_tab_cln &lt;- sam_tab[match(overlap_samples, rownames(sam_tab)), ] rownames(sam_tab_cln) &lt;- overlap_samples metaphlan2_ps &lt;- get_metaphlan_phyloseq( otu_tab = otu_tab_cln, sam_tab = sam_tab_cln, tax_tab = tax_tab) metaphlan2_ps ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 315 taxa and 145 samples ] ## sample_data() Sample Data: [ 145 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 315 taxa by 7 taxonomic ranks ] if (!dir.exists(&quot;DataSet/Step1/&quot;)) { dir.create(&quot;DataSet/Step1/&quot;) } saveRDS(metaphlan2_ps, &quot;DataSet/Step1/Donor_MGS_phyloseq.RDS&quot;, compress = TRUE) 10.4 Step2: Transform limit of detection (LOD) into Zeros # species metaphlan2_ps_LOD_species &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps, taxa_level = &quot;Species&quot;, cutoff = 1e-04) # genus metaphlan2_ps_LOD_genus &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps, taxa_level = &quot;Genus&quot;, cutoff = 1e-04) # order metaphlan2_ps_LOD_order &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps, taxa_level = &quot;Order&quot;, cutoff = 1e-04) if (!dir.exists(&quot;DataSet/Step2/&quot;)) { dir.create(&quot;DataSet/Step2/&quot;) } saveRDS(metaphlan2_ps_LOD_species, &quot;DataSet/Step2/Donor_MGS_phyloseq_LOD_species.RDS&quot;, compress = TRUE) saveRDS(metaphlan2_ps_LOD_genus, &quot;DataSet/Step2/Donor_MGS_phyloseq_LOD_genus.RDS&quot;, compress = TRUE) saveRDS(metaphlan2_ps_LOD_order, &quot;DataSet/Step2/Donor_MGS_phyloseq_LOD_order.RDS&quot;, compress = TRUE) 10.5 Step3: BRS checking metaphlan2_ps &lt;- readRDS(&quot;DataSet/Step1/Donor_MGS_phyloseq.RDS&quot;) metaphlan2_ps_LOD_species &lt;- aggregate_LOD_taxa(ps = metaphlan2_ps, taxa_level = &quot;Species&quot;, cutoff = 1e-04) tail(metaphlan2_ps_LOD_species@sam_data %&gt;% data.frame()) ## SampleTubeID Group Date_Sequencing ProductID SampleType ProductBatch Date_Sampling Date_Receiving SeqID_MGS SeqID_16s ## S_7769 GGM50-210730 Stool 2021-08-03 M50 粪便 CYM50-210735 2021.07.30 2021-08-06 7769 7929 ## S_7770 CYM50-210735-0727 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.27 2021-08-06 7770 7930 ## S_7771 CYM50-210735-0728 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.28 2021-08-06 7771 7931 ## S_7772 CYM50-210735-0729 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.29 2021-08-06 7772 7932 ## S_7773 CYM50-210735-0730 Product 2021-08-03 M50 肠菌胶囊 CYM50-210735 2021.07.30 2021-08-06 7773 7933 ## S_7222 Community QC &lt;NA&gt; Ref QC &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; 7222 7327 ## Pipeline_MGS Pipeline_16s ## S_7769 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7770 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7771 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7772 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7773 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 ## S_7222 /share/work/HPC/work_tmp/PipelineJob_180_20210923/output /share/projects/Engineering/pipeline_output/PipelineJob_304_20211203 run_RefCheck2( ps = metaphlan2_ps_LOD_species, BRS_ID = &quot;S_7222&quot;, Ref_type = &quot;MGS&quot;L) ## Noting: the Reference Matrix is for MGS ## ## ############Matched baterica of the BRS sample############# ## The number of BRS&#39; bacteria matched the Reference Matrix is [2] ## s__Enterococcus_faecalis ## s__Escherichia_coli ## The number of bacteria unmatched the Reference Matrix is [24] ## s__Propionibacterium_acnes ## s__Bifidobacterium_adolescentis ## s__Bifidobacterium_bifidum ## s__Bifidobacterium_longum ## s__Bifidobacterium_pseudocatenulatum ## s__Collinsella_aerofaciens ## s__Eggerthella_unclassified ## s__Bacteroides_fragilis ## s__Bacteroides_intestinalis ## s__Bacteroides_ovatus ## s__Bacteroides_thetaiotaomicron ## s__Bacteroides_uniformis ## s__Bacteroides_vulgatus ## s__Bacteroides_xylanisolvens ## s__Parabacteroides_goldsteinii ## s__Prevotella_copri ## s__Enterococcus_faecium ## s__Lactobacillus_pentosus ## s__Lactobacillus_salivarius ## s__Streptococcus_salivarius ## s__Coprococcus_comes ## s__Dorea_formicigenerans ## s__Roseburia_hominis ## s__Faecalibacterium_prausnitzii ## The number of the additional bacteria compared to the Reference Matrix is [2] ## ########################################################### ## ## ##################Status of the BRS sample################## ## Whether the BRS has the all bateria of Reference Matrix: FALSE ## Correlation Coefficient of the BRS is: 2.22e-16 ## Bray Curtis of the BRS is: 0.1017 ## Impurity of the BRS is: 72.95 ## ########################################################### ## #####Final Evaluation Results of the BRS ####### ## The BRS of sequencing dataset didn&#39;t pass the cutoff of the Reference Matrix ## ########################################################### ## $Matrix ## 7682 7683 7684 7685 7842 7843 7844 7845 S_7222 mean ## Propionibacterium_acnes 0.28649 0.22355 0.32199 0.28276 0.37568 0.44201 0.41135 0.39489 NA 0.30430222 ## Bifidobacterium_adolescentis 7.05611 6.28460 6.57297 6.25448 4.69357 4.80628 4.94943 4.84278 NA 5.05113556 ## Bifidobacterium_bifidum 1.32803 1.19346 1.26883 1.05154 1.34640 1.40471 1.43721 1.48097 NA 1.16790556 ## Bifidobacterium_longum 10.31832 9.25812 9.69184 7.76031 11.03311 11.61484 12.29030 11.69019 NA 9.29522556 ## Bifidobacterium_pseudocatenulatum 6.89760 6.36177 7.39605 5.76804 6.19464 6.47094 7.41615 6.27837 NA 5.86484000 ## Collinsella_aerofaciens 0.56189 0.53249 0.60476 0.47934 0.65513 0.68833 0.76063 0.66896 NA 0.55017000 ## Eggerthella_unclassified 1.21416 1.06143 1.19122 0.85743 1.36030 1.48457 1.61204 1.50700 NA 1.14312778 ## Bacteroides_fragilis 6.56752 7.19828 7.27658 7.31998 7.10174 6.70626 6.60219 6.11088 NA 6.09815889 ## Bacteroides_intestinalis 0.09448 0.09550 0.10216 0.09326 0.08448 0.09556 0.08852 0.10469 NA 0.08429444 ## Bacteroides_ovatus 3.08552 3.27226 3.10904 3.24565 3.51376 3.50063 3.37872 3.42300 NA 2.94762000 ## Bacteroides_thetaiotaomicron 3.24207 3.31897 3.22418 3.43809 3.35611 3.38323 3.29098 3.30355 NA 2.95079778 ## Bacteroides_uniformis 2.24271 2.24035 1.92015 2.18435 2.43230 2.38180 2.13830 2.41437 NA 1.99492556 ## Bacteroides_vulgatus 3.06672 3.20369 3.14979 3.15352 3.24822 3.09280 3.13038 3.06113 NA 2.78958333 ## Bacteroides_xylanisolvens 1.55687 1.84824 1.91166 1.85273 1.75220 1.74002 1.69811 1.67676 NA 1.55962111 ## Parabacteroides_goldsteinii 5.92564 5.95499 6.04638 5.85282 6.85811 6.50800 6.35758 6.96646 NA 5.60777556 ## Prevotella_copri 2.03757 1.99619 1.92504 2.15422 1.57638 1.60584 1.57913 1.59224 NA 1.60740111 ## Enterococcus_faecalis 11.46695 12.46200 11.92117 11.95884 13.71474 13.67805 13.21782 13.27297 17.19286 13.20948889 ## Enterococcus_faecium 4.57147 4.64943 4.52463 4.76407 5.45590 5.17641 5.15276 5.24896 NA 4.39373667 ## Lactobacillus_pentosus 0.75844 0.75524 0.72958 0.80796 0.91548 0.89940 0.81308 0.94831 NA 0.73638778 ## Lactobacillus_salivarius 4.89005 5.18462 5.12745 7.79194 2.72469 2.25673 2.10356 2.02202 NA 3.56678444 ## Streptococcus_salivarius 3.54220 3.74119 3.62036 4.01546 2.90216 2.70193 2.61760 2.57348 NA 2.85715333 ## Coprococcus_comes 2.28009 2.42978 2.25227 2.82904 1.21527 1.16485 1.07160 1.07834 NA 1.59124889 ## Dorea_formicigenerans 4.83413 5.02149 5.18268 5.56891 3.34720 3.09877 3.08677 2.70732 NA 3.64969667 ## Roseburia_hominis 0.04384 0.04183 0.04107 0.02304 0.03853 0.03464 0.03532 0.03597 NA 0.03269333 ## Faecalibacterium_prausnitzii 0.65572 0.60153 0.60112 0.62079 0.54147 0.55383 0.58806 0.54655 NA 0.52323000 ## Escherichia_coli 8.76957 8.33337 7.70416 8.11247 10.44118 10.33823 9.96261 11.06988 9.85431 9.39842000 ## Impurity_level 2.70584 2.73563 2.58287 1.75896 3.12125 4.17134 4.20980 4.97996 72.95000 11.02396111 ## Evaluation ## Propionibacterium_acnes S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bifidobacterium_adolescentis S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bifidobacterium_bifidum S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bifidobacterium_longum S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bifidobacterium_pseudocatenulatum S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Collinsella_aerofaciens S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Eggerthella_unclassified S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bacteroides_fragilis S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bacteroides_intestinalis S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bacteroides_ovatus S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bacteroides_thetaiotaomicron S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bacteroides_uniformis S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bacteroides_vulgatus S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Bacteroides_xylanisolvens S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Parabacteroides_goldsteinii S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Prevotella_copri S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Enterococcus_faecalis S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Enterococcus_faecium S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Lactobacillus_pentosus S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Lactobacillus_salivarius S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Streptococcus_salivarius S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Coprococcus_comes S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Dorea_formicigenerans S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Roseburia_hominis S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Faecalibacterium_prausnitzii S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Escherichia_coli S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## Impurity_level S_7222 didn&#39;t pass the threshold (2023-10-27 16:59:47). ## ## $Assess ## Gold_Cutoff BRS ## Coef 0.8726 2.220e-16 ## Bray 0.2064 1.017e-01 ## Impurity 6.4400 7.295e+01 metaphlan2_ps_LOD_species_remove_BRS &lt;- get_GroupPhyloseq( ps = metaphlan2_ps_LOD_species, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) metaphlan2_ps_LOD_species_remove_BRS ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 180 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 180 taxa by 7 taxonomic ranks ] if (!dir.exists(&quot;DataSet/Step3/&quot;)) { dir.create(&quot;DataSet/Step3/&quot;) } saveRDS(metaphlan2_ps_LOD_species_remove_BRS, &quot;DataSet/Step3/Donor_MGS_phyloseq_LOD_species_remove_BRS.RDS&quot;, compress = TRUE) 10.6 Step4: Extracting specific taxonomic level Removing spike-in sample (BRS) metaphlan2_ps &lt;- readRDS(&quot;DataSet/Step1/Donor_MGS_phyloseq.RDS&quot;) metaphlan2_ps_remove_BRS &lt;- get_GroupPhyloseq( ps = metaphlan2_ps, group = &quot;Group&quot;, group_names = &quot;QC&quot;, discard = TRUE) metaphlan2_ps_LOD_species_remove_BRS ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 180 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 180 taxa by 7 taxonomic ranks ] Species metaphlan2_ps_remove_BRS_LOD_species &lt;- aggregate_LOD_taxa( ps = metaphlan2_ps_remove_BRS, taxa_level = &quot;Species&quot;, cutoff = 1e-04) metaphlan2_ps_remove_BRS_LOD_species ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 180 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 180 taxa by 7 taxonomic ranks ] Genus metaphlan2_ps_remove_BRS_LOD_genus &lt;- aggregate_LOD_taxa( ps = metaphlan2_ps_remove_BRS, taxa_level = &quot;Genus&quot;, cutoff = 1e-04) metaphlan2_ps_remove_BRS_LOD_genus ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 67 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 67 taxa by 6 taxonomic ranks ] Phylum metaphlan2_ps_remove_BRS_LOD_phylum &lt;- aggregate_LOD_taxa( ps = metaphlan2_ps_remove_BRS, taxa_level = &quot;Phylum&quot;, cutoff = 1e-04) metaphlan2_ps_remove_BRS_LOD_phylum ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 7 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 7 taxa by 2 taxonomic ranks ] output if (!dir.exists(&quot;DataSet/Step4/&quot;)) { dir.create(&quot;DataSet/Step4/&quot;) } saveRDS(metaphlan2_ps_remove_BRS_LOD_species, &quot;DataSet/Step4/Donor_MGS_phyloseq_remove_BRS_LOD_species.RDS&quot;, compress = TRUE) saveRDS(metaphlan2_ps_remove_BRS_LOD_genus, &quot;DataSet/Step4/Donor_MGS_phyloseq_remove_BRS_LOD_genus.RDS&quot;, compress = TRUE) saveRDS(metaphlan2_ps_remove_BRS_LOD_phylum, &quot;DataSet/Step4/Donor_MGS_phyloseq_remove_BRS_LOD_phylum.RDS&quot;, compress = TRUE) 10.7 Step5: GlobalView metaphlan2_ps_remove_BRS_LOD_species &lt;- readRDS(&quot;DataSet/Step4/Donor_MGS_phyloseq_remove_BRS_LOD_species.RDS&quot;) # alpha metaphlan2_ps_remove_BRS_species_alpha &lt;- run_alpha_diversity( ps = metaphlan2_ps_remove_BRS_LOD_species, measures = c(&quot;Shannon&quot;, &quot;Simpson&quot;, &quot;InvSimpson&quot;)) plot_boxplot(data = metaphlan2_ps_remove_BRS_species_alpha, y_index = c(&quot;Shannon&quot;, &quot;Simpson&quot;, &quot;InvSimpson&quot;), group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), group_color = c(&quot;red&quot;, &quot;blue&quot;)) Figure 10.1: diversity and ordination and composition(Example) # beta metaphlan2_ps_remove_BRS_species_beta &lt;- run_beta_diversity( ps = metaphlan2_ps_remove_BRS_LOD_species, method = &quot;bray&quot;) plot_distance_corrplot(datMatrix = metaphlan2_ps_remove_BRS_species_beta$BetaDistance) Figure 10.2: diversity and ordination and composition(Example) # permanova run_permanova(ps = metaphlan2_ps_remove_BRS_LOD_species, method = &quot;bray&quot;, columns = &quot;Group&quot;) ## SumsOfSample Df SumsOfSqs MeanSqs F.Model R2 Pr(&gt;F) AdjustedPvalue ## Group 144 1 1.328635 1.328635 6.307557 0.04253025 0.001 0.001 # beta dispersion beta_df &lt;- run_beta_diversity(ps = metaphlan2_ps_remove_BRS_LOD_species, method = &quot;bray&quot;, group = &quot;Group&quot;) ## ## Permutation test for homogeneity of multivariate dispersions ## Permutation: free ## Number of permutations: 999 ## ## Response: Distances ## Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) ## Groups 1 0.01652 0.016518 1.1697 999 0.282 ## Residuals 142 2.00532 0.014122 ## ## Pairwise comparisons: ## (Observed p-value below diagonal, permuted p-value above diagonal) ## Product Stool ## Product 0.281 ## Stool 0.28129 # ordination metaphlan2_ps_ordination &lt;- run_ordination( ps = metaphlan2_ps_remove_BRS_LOD_species, group = &quot;Group&quot;, method = &quot;PCoA&quot;) plot_Ordination(ResultList = metaphlan2_ps_ordination, group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), group_color = c(&quot;blue&quot;, &quot;red&quot;)) Figure 10.3: diversity and ordination and composition(Example) # Microbial composition plot_stacked_bar_XIVZ( phyloseq = metaphlan2_ps_remove_BRS_LOD_species, level = &quot;Phylum&quot;, feature = &quot;Group&quot;) Figure 10.4: diversity and ordination and composition(Example) 10.8 Step6: Differential Analysis metaphlan2_ps_remove_BRS_LOD_species &lt;- readRDS(&quot;DataSet/Step4/Donor_MGS_phyloseq_remove_BRS_LOD_species.RDS&quot;) # filter &amp; trim metaphlan2_ps_remove_BRS_species_filter &lt;- run_filter(ps = metaphlan2_ps_remove_BRS_LOD_species, cutoff = 1e-4, unclass = TRUE) metaphlan2_ps_remove_BRS_species_filter_trim &lt;- run_trim(object = metaphlan2_ps_remove_BRS_species_filter, cutoff = 0.1, trim = &quot;feature&quot;) metaphlan2_ps_remove_BRS_species_filter_trim ## phyloseq-class experiment-level object ## otu_table() OTU Table: [ 110 taxa and 144 samples ] ## sample_data() Sample Data: [ 144 samples by 12 sample variables ] ## tax_table() Taxonomy Table: [ 110 taxa by 7 taxonomic ranks ] # lefse # metaphlan2_ps_lefse &lt;- run_lefse( # ps = metaphlan2_ps_remove_BRS_species_filter_trim, # group = &quot;Group&quot;, # group_names = c(&quot;Stool&quot;, &quot;Product&quot;), # norm = &quot;CPM&quot;, # Lda = 2) metaphlan2_ps_lefse &lt;- run_lefse2( ps = metaphlan2_ps_remove_BRS_species_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), norm = &quot;CPM&quot;, lda_cutoff = 2) # # don&#39;t run this code when you do lefse in reality # metaphlan2_ps_lefse$LDA_Score &lt;- metaphlan2_ps_lefse$LDA_Score * 1000 plot_lefse( da_res = metaphlan2_ps_lefse, x_index = &quot;LDA_Score&quot;, x_index_cutoff = 2, group_color = c(&quot;green&quot;, &quot;red&quot;)) Figure 10.5: Differential Analysis (Example) metaphlan2_ps_wilcox &lt;- run_wilcox( ps = metaphlan2_ps_remove_BRS_species_filter_trim, group = &quot;Group&quot;, group_names = c(&quot;Stool&quot;, &quot;Product&quot;)) plot_volcano( da_res = metaphlan2_ps_wilcox, group_names = c(&quot;Stool&quot;, &quot;Product&quot;), x_index = &quot;Log2FoldChange (Rank)\\nStool_vs_Product&quot;, x_index_cutoff = 0.5, y_index = &quot;Pvalue&quot;, y_index_cutoff = 0.05, group_color = c(&quot;red&quot;, &quot;grey&quot;, &quot;blue&quot;), topN = 5) Figure 10.6: Differential Analysis (Example) if (!dir.exists(&quot;DataSet/Step8/&quot;)) { dir.create(&quot;DataSet/Step8/&quot;) } saveRDS(metaphlan2_ps_remove_BRS_species_filter_trim, &quot;DataSet/Step6/Donor_MGS_phyloseq_remove_BRS_species_filter_trim.RDS&quot;, compress = TRUE) 10.9 Systematic Information devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.1.3 (2022-03-10) ## os macOS Monterey 12.2.1 ## system x86_64, darwin17.0 ## ui RStudio ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz Asia/Shanghai ## date 2023-10-27 ## rstudio 2023.09.0+463 Desert Sunflower (desktop) ## pandoc 3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [2] CRAN (R 4.1.0) ## ade4 1.7-22 2023-02-06 [2] CRAN (R 4.1.2) ## ALDEx2 1.30.0 2022-11-01 [2] Bioconductor ## annotate 1.72.0 2021-10-26 [2] Bioconductor ## AnnotationDbi 1.60.2 2023-03-10 [2] Bioconductor ## ape * 5.7-1 2023-03-13 [2] CRAN (R 4.1.2) ## askpass 1.1 2019-01-13 [2] CRAN (R 4.1.0) ## backports 1.4.1 2021-12-13 [2] CRAN (R 4.1.0) ## base64enc 0.1-3 2015-07-28 [2] CRAN (R 4.1.0) ## bayesm 3.1-5 2022-12-02 [2] CRAN (R 4.1.2) ## Biobase * 2.54.0 2021-10-26 [2] Bioconductor ## BiocGenerics * 0.40.0 2021-10-26 [2] Bioconductor ## BiocParallel 1.28.3 2021-12-09 [2] Bioconductor ## biomformat 1.22.0 2021-10-26 [2] Bioconductor ## Biostrings 2.62.0 2021-10-26 [2] Bioconductor ## bit 4.0.5 2022-11-15 [2] CRAN (R 4.1.2) ## bit64 4.0.5 2020-08-30 [2] CRAN (R 4.1.0) ## bitops 1.0-7 2021-04-24 [2] CRAN (R 4.1.0) ## blob 1.2.4 2023-03-17 [2] CRAN (R 4.1.2) ## bookdown 0.34 2023-05-09 [2] CRAN (R 4.1.2) ## broom 1.0.5 2023-06-09 [2] CRAN (R 4.1.3) ## bslib 0.5.0 2023-06-09 [2] CRAN (R 4.1.3) ## cachem 1.0.8 2023-05-01 [2] CRAN (R 4.1.2) ## callr 3.7.3 2022-11-02 [2] CRAN (R 4.1.2) ## car 3.1-2 2023-03-30 [2] CRAN (R 4.1.2) ## carData 3.0-5 2022-01-06 [2] CRAN (R 4.1.2) ## caTools 1.18.2 2021-03-28 [2] CRAN (R 4.1.0) ## cccd 1.6 2022-04-08 [2] CRAN (R 4.1.2) ## cellranger 1.1.0 2016-07-27 [2] CRAN (R 4.1.0) ## checkmate 2.2.0 2023-04-27 [2] CRAN (R 4.1.2) ## class 7.3-22 2023-05-03 [2] CRAN (R 4.1.2) ## classInt 0.4-9 2023-02-28 [2] CRAN (R 4.1.2) ## cli 3.6.1 2023-03-23 [2] CRAN (R 4.1.2) ## cluster 2.1.4 2022-08-22 [2] CRAN (R 4.1.2) ## coda 0.19-4 2020-09-30 [2] CRAN (R 4.1.0) ## codetools 0.2-19 2023-02-01 [2] CRAN (R 4.1.2) ## coin 1.4-2 2021-10-08 [2] CRAN (R 4.1.0) ## colorspace 2.1-0 2023-01-23 [2] CRAN (R 4.1.2) ## compositions 2.0-6 2023-04-13 [2] CRAN (R 4.1.2) ## conflicted * 1.2.0 2023-02-01 [2] CRAN (R 4.1.2) ## corpcor 1.6.10 2021-09-16 [2] CRAN (R 4.1.0) ## corrplot 0.92 2021-11-18 [2] CRAN (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [2] CRAN (R 4.1.0) ## crayon 1.5.2 2022-09-29 [2] CRAN (R 4.1.2) ## crosstalk 1.2.0 2021-11-04 [2] CRAN (R 4.1.0) ## data.table 1.14.8 2023-02-17 [2] CRAN (R 4.1.2) ## DBI 1.1.3 2022-06-18 [2] CRAN (R 4.1.2) ## DelayedArray 0.20.0 2021-10-26 [2] Bioconductor ## deldir 1.0-9 2023-05-17 [2] CRAN (R 4.1.3) ## DEoptimR 1.0-14 2023-06-09 [2] CRAN (R 4.1.3) ## DESeq2 1.34.0 2021-10-26 [2] Bioconductor ## devtools * 2.4.5 2022-10-11 [2] CRAN (R 4.1.2) ## digest 0.6.33 2023-07-07 [1] CRAN (R 4.1.3) ## doParallel 1.0.17 2022-02-07 [2] CRAN (R 4.1.2) ## doSNOW 1.0.20 2022-02-04 [2] CRAN (R 4.1.2) ## dplyr * 1.1.2 2023-04-20 [2] CRAN (R 4.1.2) ## DT 0.28 2023-05-18 [2] CRAN (R 4.1.3) ## dynamicTreeCut 1.63-1 2016-03-11 [2] CRAN (R 4.1.0) ## e1071 1.7-13 2023-02-01 [2] CRAN (R 4.1.2) ## edgeR 3.36.0 2021-10-26 [2] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] CRAN (R 4.1.0) ## emmeans 1.8.7 2023-06-23 [1] CRAN (R 4.1.3) ## estimability 1.4.1 2022-08-05 [2] CRAN (R 4.1.2) ## evaluate 0.21 2023-05-05 [2] CRAN (R 4.1.2) ## FactoMineR 2.8 2023-03-27 [2] CRAN (R 4.1.2) ## fansi 1.0.4 2023-01-22 [2] CRAN (R 4.1.2) ## farver 2.1.1 2022-07-06 [2] CRAN (R 4.1.2) ## fastcluster 1.2.3 2021-05-24 [2] CRAN (R 4.1.0) ## fastmap 1.1.1 2023-02-24 [2] CRAN (R 4.1.2) ## fdrtool 1.2.17 2021-11-13 [2] CRAN (R 4.1.0) ## filematrix 1.3 2018-02-27 [2] CRAN (R 4.1.0) ## flashClust 1.01-2 2012-08-21 [2] CRAN (R 4.1.0) ## FNN 1.1.3.2 2023-03-20 [2] CRAN (R 4.1.2) ## foreach 1.5.2 2022-02-02 [2] CRAN (R 4.1.2) ## foreign 0.8-84 2022-12-06 [2] CRAN (R 4.1.2) ## forestplot 3.1.1 2022-12-06 [2] CRAN (R 4.1.2) ## formatR 1.14 2023-01-17 [2] CRAN (R 4.1.2) ## Formula 1.2-5 2023-02-24 [2] CRAN (R 4.1.2) ## fs 1.6.2 2023-04-25 [2] CRAN (R 4.1.2) ## futile.logger * 1.4.3 2016-07-10 [2] CRAN (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [2] CRAN (R 4.1.0) ## genefilter 1.76.0 2021-10-26 [2] Bioconductor ## geneplotter 1.72.0 2021-10-26 [2] Bioconductor ## generics 0.1.3 2022-07-05 [2] CRAN (R 4.1.2) ## GenomeInfoDb * 1.30.1 2022-01-30 [2] Bioconductor ## GenomeInfoDbData 1.2.7 2022-03-09 [2] Bioconductor ## GenomicRanges * 1.46.1 2021-11-18 [2] Bioconductor ## ggiraph 0.8.7 2023-03-17 [2] CRAN (R 4.1.2) ## ggiraphExtra 0.3.0 2020-10-06 [2] CRAN (R 4.1.2) ## ggplot2 * 3.4.2 2023-04-03 [2] CRAN (R 4.1.2) ## ggpubr * 0.6.0 2023-02-10 [2] CRAN (R 4.1.2) ## ggrepel 0.9.3 2023-02-03 [2] CRAN (R 4.1.2) ## ggsci 3.0.0 2023-03-08 [2] CRAN (R 4.1.2) ## ggsignif 0.6.4 2022-10-13 [2] CRAN (R 4.1.2) ## ggVennDiagram 1.2.2 2022-09-08 [2] CRAN (R 4.1.2) ## glasso 1.11 2019-10-01 [2] CRAN (R 4.1.0) ## glmnet 4.1-7 2023-03-23 [2] CRAN (R 4.1.2) ## glue * 1.6.2 2022-02-24 [2] CRAN (R 4.1.2) ## Gmisc * 3.0.2 2023-03-13 [2] CRAN (R 4.1.2) ## GO.db 3.14.0 2022-04-11 [2] Bioconductor ## gplots 3.1.3 2022-04-25 [2] CRAN (R 4.1.2) ## gridExtra 2.3 2017-09-09 [2] CRAN (R 4.1.0) ## gtable 0.3.3 2023-03-21 [2] CRAN (R 4.1.2) ## gtools 3.9.4 2022-11-27 [2] CRAN (R 4.1.2) ## highr 0.10 2022-12-22 [2] CRAN (R 4.1.2) ## Hmisc 5.1-0 2023-05-08 [2] CRAN (R 4.1.2) ## hms 1.1.3 2023-03-21 [2] CRAN (R 4.1.2) ## htmlTable * 2.4.1 2022-07-07 [2] CRAN (R 4.1.2) ## htmltools 0.5.5 2023-03-23 [2] CRAN (R 4.1.2) ## htmlwidgets 1.6.2 2023-03-17 [2] CRAN (R 4.1.2) ## httpuv 1.6.11 2023-05-11 [2] CRAN (R 4.1.3) ## httr 1.4.6 2023-05-08 [2] CRAN (R 4.1.2) ## huge 1.3.5 2021-06-30 [2] CRAN (R 4.1.0) ## igraph 1.5.0 2023-06-16 [1] CRAN (R 4.1.3) ## impute 1.68.0 2021-10-26 [2] Bioconductor ## insight 0.19.3 2023-06-29 [2] CRAN (R 4.1.3) ## IRanges * 2.28.0 2021-10-26 [2] Bioconductor ## irlba 2.3.5.1 2022-10-03 [2] CRAN (R 4.1.2) ## iterators 1.0.14 2022-02-05 [2] CRAN (R 4.1.2) ## jpeg 0.1-10 2022-11-29 [2] CRAN (R 4.1.2) ## jquerylib 0.1.4 2021-04-26 [2] CRAN (R 4.1.0) ## jsonlite 1.8.7 2023-06-29 [2] CRAN (R 4.1.3) ## kableExtra 1.3.4 2021-02-20 [2] CRAN (R 4.1.2) ## KEGGREST 1.34.0 2021-10-26 [2] Bioconductor ## KernSmooth 2.23-22 2023-07-10 [2] CRAN (R 4.1.3) ## knitr 1.43 2023-05-25 [2] CRAN (R 4.1.3) ## labeling 0.4.2 2020-10-20 [2] CRAN (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [2] CRAN (R 4.1.0) ## later 1.3.1 2023-05-02 [2] CRAN (R 4.1.2) ## lattice * 0.21-8 2023-04-05 [2] CRAN (R 4.1.2) ## lavaan 0.6-15 2023-03-14 [2] CRAN (R 4.1.2) ## leaps 3.1 2020-01-16 [2] CRAN (R 4.1.0) ## libcoin 1.0-9 2021-09-27 [2] CRAN (R 4.1.0) ## lifecycle 1.0.3 2022-10-07 [2] CRAN (R 4.1.2) ## limma 3.50.3 2022-04-07 [2] Bioconductor ## locfit 1.5-9.8 2023-06-11 [2] CRAN (R 4.1.3) ## LOCOM 1.1 2022-08-05 [2] Github (yijuanhu/LOCOM@c181e0f) ## lubridate 1.9.2 2023-02-10 [2] CRAN (R 4.1.2) ## magrittr * 2.0.3 2022-03-30 [2] CRAN (R 4.1.2) ## MASS 7.3-60 2023-05-04 [2] CRAN (R 4.1.2) ## Matrix 1.6-0 2023-07-08 [2] CRAN (R 4.1.3) ## MatrixGenerics * 1.6.0 2021-10-26 [2] Bioconductor ## matrixStats * 1.0.0 2023-06-02 [2] CRAN (R 4.1.3) ## mbzinb 0.2 2022-03-16 [2] local ## memoise 2.0.1 2021-11-26 [2] CRAN (R 4.1.0) ## metagenomeSeq 1.36.0 2021-10-26 [2] Bioconductor ## mgcv 1.8-42 2023-03-02 [2] CRAN (R 4.1.2) ## microbiome 1.16.0 2021-10-26 [2] Bioconductor ## mime 0.12 2021-09-28 [2] CRAN (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [2] CRAN (R 4.1.0) ## mixedCCA 1.6.2 2022-09-09 [2] CRAN (R 4.1.2) ## mnormt 2.1.1 2022-09-26 [2] CRAN (R 4.1.2) ## modeltools 0.2-23 2020-03-05 [2] CRAN (R 4.1.0) ## multcomp 1.4-25 2023-06-20 [2] CRAN (R 4.1.3) ## multcompView 0.1-9 2023-04-09 [2] CRAN (R 4.1.2) ## multtest 2.50.0 2021-10-26 [2] Bioconductor ## munsell 0.5.0 2018-06-12 [2] CRAN (R 4.1.0) ## mvtnorm 1.2-2 2023-06-08 [2] CRAN (R 4.1.3) ## mycor 0.1.1 2018-04-10 [2] CRAN (R 4.1.0) ## NADA 1.6-1.1 2020-03-22 [2] CRAN (R 4.1.0) ## NetCoMi * 1.0.3 2022-07-14 [2] Github (stefpeschel/NetCoMi@d4d80d3) ## nlme * 3.1-162 2023-01-31 [2] CRAN (R 4.1.2) ## nnet 7.3-19 2023-05-03 [2] CRAN (R 4.1.2) ## openssl 2.0.6 2023-03-09 [2] CRAN (R 4.1.2) ## pbapply 1.7-2 2023-06-27 [2] CRAN (R 4.1.3) ## pbivnorm 0.6.0 2015-01-23 [2] CRAN (R 4.1.0) ## pcaPP 2.0-3 2022-10-24 [2] CRAN (R 4.1.2) ## permute * 0.9-7 2022-01-27 [2] CRAN (R 4.1.2) ## pheatmap * 1.0.12 2019-01-04 [2] CRAN (R 4.1.0) ## phyloseq * 1.38.0 2021-10-26 [2] Bioconductor ## picante * 1.8.2 2020-06-10 [2] CRAN (R 4.1.0) ## pillar 1.9.0 2023-03-22 [2] CRAN (R 4.1.2) ## pkgbuild 1.4.2 2023-06-26 [2] CRAN (R 4.1.3) ## pkgconfig 2.0.3 2019-09-22 [2] CRAN (R 4.1.0) ## pkgload 1.3.2.1 2023-07-08 [2] CRAN (R 4.1.3) ## plyr 1.8.8 2022-11-11 [2] CRAN (R 4.1.2) ## png 0.1-8 2022-11-29 [2] CRAN (R 4.1.2) ## ppcor 1.1 2015-12-03 [2] CRAN (R 4.1.0) ## preprocessCore 1.56.0 2021-10-26 [2] Bioconductor ## prettyunits 1.1.1 2020-01-24 [2] CRAN (R 4.1.0) ## processx 3.8.2 2023-06-30 [2] CRAN (R 4.1.3) ## profvis 0.3.8 2023-05-02 [2] CRAN (R 4.1.2) ## promises 1.2.0.1 2021-02-11 [2] CRAN (R 4.1.0) ## protoclust 1.6.4 2022-04-01 [2] CRAN (R 4.1.2) ## proxy 0.4-27 2022-06-09 [2] CRAN (R 4.1.2) ## ps 1.7.5 2023-04-18 [2] CRAN (R 4.1.2) ## pscl 1.5.5.1 2023-05-10 [2] CRAN (R 4.1.2) ## psych 2.3.6 2023-06-21 [2] CRAN (R 4.1.3) ## pulsar 0.3.10 2023-01-26 [2] CRAN (R 4.1.2) ## purrr * 1.0.1 2023-01-10 [2] CRAN (R 4.1.2) ## qgraph 1.9.5 2023-05-16 [2] CRAN (R 4.1.3) ## quadprog 1.5-8 2019-11-20 [2] CRAN (R 4.1.0) ## qvalue 2.26.0 2021-10-26 [2] Bioconductor ## R6 2.5.1 2021-08-19 [2] CRAN (R 4.1.0) ## RAIDA 1.0 2022-03-14 [2] local ## rbibutils 2.2.13 2023-01-13 [2] CRAN (R 4.1.2) ## RColorBrewer * 1.1-3 2022-04-03 [2] CRAN (R 4.1.2) ## Rcpp * 1.0.11 2023-07-06 [1] CRAN (R 4.1.3) ## RcppZiggurat 0.1.6 2020-10-20 [2] CRAN (R 4.1.0) ## RCurl 1.98-1.12 2023-03-27 [2] CRAN (R 4.1.2) ## Rdpack 2.4 2022-07-20 [2] CRAN (R 4.1.2) ## readr * 2.1.4 2023-02-10 [2] CRAN (R 4.1.2) ## readxl * 1.4.3 2023-07-06 [2] CRAN (R 4.1.3) ## remotes 2.4.2 2021-11-30 [2] CRAN (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [2] CRAN (R 4.1.0) ## reticulate 1.30 2023-06-09 [2] CRAN (R 4.1.3) ## Rfast 2.0.8 2023-07-03 [2] CRAN (R 4.1.3) ## rhdf5 2.38.1 2022-03-10 [2] Bioconductor ## rhdf5filters 1.6.0 2021-10-26 [2] Bioconductor ## Rhdf5lib 1.16.0 2021-10-26 [2] Bioconductor ## rlang 1.1.1 2023-04-28 [1] CRAN (R 4.1.2) ## rmarkdown 2.23 2023-07-01 [2] CRAN (R 4.1.3) ## robustbase 0.99-0 2023-06-16 [2] CRAN (R 4.1.3) ## rootSolve 1.8.2.3 2021-09-29 [2] CRAN (R 4.1.0) ## rpart 4.1.19 2022-10-21 [2] CRAN (R 4.1.2) ## RSpectra 0.16-1 2022-04-24 [2] CRAN (R 4.1.2) ## RSQLite 2.3.1 2023-04-03 [2] CRAN (R 4.1.2) ## rstatix 0.7.2 2023-02-01 [2] CRAN (R 4.1.2) ## rstudioapi 0.15.0 2023-07-07 [2] CRAN (R 4.1.3) ## Rtsne 0.16 2022-04-17 [2] CRAN (R 4.1.2) ## RVenn 1.1.0 2019-07-18 [2] CRAN (R 4.1.0) ## rvest 1.0.3 2022-08-19 [2] CRAN (R 4.1.2) ## S4Vectors * 0.32.4 2022-03-29 [2] Bioconductor ## sandwich 3.0-2 2022-06-15 [2] CRAN (R 4.1.2) ## sass 0.4.6 2023-05-03 [2] CRAN (R 4.1.2) ## scales 1.2.1 2022-08-20 [2] CRAN (R 4.1.2) ## scatterplot3d 0.3-44 2023-05-05 [2] CRAN (R 4.1.2) ## sessioninfo 1.2.2 2021-12-06 [2] CRAN (R 4.1.0) ## sf 1.0-7 2022-03-07 [2] CRAN (R 4.1.2) ## shape 1.4.6 2021-05-19 [2] CRAN (R 4.1.0) ## shiny 1.7.4.1 2023-07-06 [2] CRAN (R 4.1.3) ## sjlabelled 1.2.0 2022-04-10 [2] CRAN (R 4.1.2) ## sjmisc 2.8.9 2021-12-03 [2] CRAN (R 4.1.0) ## snow 0.4-4 2021-10-27 [2] CRAN (R 4.1.0) ## SpiecEasi * 1.1.2 2022-07-14 [2] Github (zdk123/SpiecEasi@c463727) ## SPRING 1.0.4 2022-08-03 [2] Github (GraceYoon/SPRING@3d641a4) ## stringi 1.7.12 2023-01-11 [2] CRAN (R 4.1.2) ## stringr 1.5.0 2022-12-02 [2] CRAN (R 4.1.2) ## SummarizedExperiment * 1.24.0 2021-10-26 [2] Bioconductor ## survival 3.5-5 2023-03-12 [2] CRAN (R 4.1.2) ## svglite 2.1.1 2023-01-10 [2] CRAN (R 4.1.2) ## systemfonts 1.0.4 2022-02-11 [2] CRAN (R 4.1.2) ## tensorA 0.36.2 2020-11-19 [2] CRAN (R 4.1.0) ## TH.data 1.1-2 2023-04-17 [2] CRAN (R 4.1.2) ## tibble * 3.2.1 2023-03-20 [2] CRAN (R 4.1.2) ## tidyr * 1.3.0 2023-01-24 [2] CRAN (R 4.1.2) ## tidyselect 1.2.0 2022-10-10 [2] CRAN (R 4.1.2) ## timechange 0.2.0 2023-01-11 [2] CRAN (R 4.1.2) ## truncnorm 1.0-9 2023-03-20 [2] CRAN (R 4.1.2) ## tzdb 0.4.0 2023-05-12 [2] CRAN (R 4.1.3) ## umap 0.2.10.0 2023-02-01 [2] CRAN (R 4.1.2) ## units 0.8-2 2023-04-27 [2] CRAN (R 4.1.2) ## urlchecker 1.0.1 2021-11-30 [2] CRAN (R 4.1.0) ## usethis * 2.2.2 2023-07-06 [2] CRAN (R 4.1.3) ## utf8 1.2.3 2023-01-31 [2] CRAN (R 4.1.2) ## uuid 1.1-0 2022-04-19 [2] CRAN (R 4.1.2) ## vctrs 0.6.3 2023-06-14 [1] CRAN (R 4.1.3) ## vegan * 2.6-4 2022-10-11 [2] CRAN (R 4.1.2) ## VennDiagram * 1.7.3 2022-04-12 [2] CRAN (R 4.1.2) ## VGAM 1.1-8 2023-03-09 [2] CRAN (R 4.1.2) ## viridis * 0.6.3 2023-05-03 [2] CRAN (R 4.1.2) ## viridisLite * 0.4.2 2023-05-02 [2] CRAN (R 4.1.2) ## vroom 1.6.3 2023-04-28 [2] CRAN (R 4.1.2) ## webshot 0.5.5 2023-06-26 [2] CRAN (R 4.1.3) ## WGCNA 1.72-1 2023-01-18 [2] CRAN (R 4.1.2) ## withr 2.5.0 2022-03-03 [2] CRAN (R 4.1.2) ## Wrench 1.12.0 2021-10-26 [2] Bioconductor ## xfun 0.40 2023-08-09 [1] CRAN (R 4.1.3) ## XMAS2 * 2.2.0 2023-10-27 [1] local ## XML 3.99-0.14 2023-03-19 [2] CRAN (R 4.1.2) ## xml2 1.3.5 2023-07-06 [2] CRAN (R 4.1.3) ## xtable 1.8-4 2019-04-21 [2] CRAN (R 4.1.0) ## XVector 0.34.0 2021-10-26 [2] Bioconductor ## yaml 2.3.7 2023-01-23 [2] CRAN (R 4.1.2) ## zCompositions 1.4.0-1 2022-03-26 [2] CRAN (R 4.1.2) ## zlibbioc 1.40.0 2021-10-26 [2] Bioconductor ## zoo 1.8-12 2023-04-13 [2] CRAN (R 4.1.2) ## ## [1] /Users/zouhua/Library/R/x86_64/4.1/library ## [2] /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## ## ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
